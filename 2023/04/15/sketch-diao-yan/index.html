<!DOCTYPE html>
<html>
  <!-- meta/link... -->
  



<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <title>sketch调研 | Jan&#39;s Blog</title>

  <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1911880_c1nvbyezg17.css">
  <link href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
  <link href="/js/swiper/swiper@5.4.1.min.css" rel="stylesheet">
  
  
    <script>
        var themeModelId = '';
        if (themeModelId) {
            localStorage.setItem('modelId', themeModelId);
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/gh/yuang01/live2d-widget@latest/autoload.js"></script>
    <script>
        var live2dOpen = eval('true') || false;
        if (!live2dOpen) {
            localStorage.setItem('waifu-display', 1609323474481);
        }
    </script>
  
  
  
<link rel="stylesheet" href="/css/animate.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
  
    
<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/js/shareJs/share.min.css">

  
  <style>
        @media (max-width: 992px) {
            #waifu {
                display: none;
            }
        }
    </style>
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

    

    <!-- import link -->
    
        
            
        
            
        
    
    <!-- import script -->
    
        
            
        
            
        
    

<meta name="generator" content="Hexo 5.4.2"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="alternate" href="/atom.xml" title="Jan's Blog" type="application/atom+xml">
</head>

  
  <!-- 依赖于jquery和vue -->
  
    
<script src="https://unpkg.com/jquery@3.5.1/dist/jquery.min.js"></script>

  

  
    
<script src="https://unpkg.com/vue@2.6.11/dist/vue.min.js"></script>

  
  
  <!-- 预加载动画 -->
  <!-- 页面预加载动画 -->

  
    <div class="preloader_2" id="loader">
  <div class="loader"></div>
</div>

  
<script>
  var endLoading = function () {
    document.body.style.overflow = 'auto';
    document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('DOMContentLoaded',endLoading);
</script>

  <body>
    <!-- 判断是否为暗黑风格 -->
    <!-- 判断是否为黑夜模式 -->
<script>
  let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');

  if (isDark) {
    $(document.body).addClass('darkModel');
  }
</script>

    <!-- 需要在上面加载的js -->
    <script>
  function loadScript(src, cb) {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }

  //https://github.com/filamentgroup/loadCSS
  var loadCSS = function (src) {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  };

</script> 

<!-- 轮播图所需要的js -->
<script src="/js/swiper/swiper.min.js"></script>
<script src="/js/swiper/vue-awesome-swiper.js"></script>
<script src="/js/swiper/swiper.animate1.0.3.min.js"></script>

<script type="text/javascript">
  Vue.use(window.VueAwesomeSwiper)
</script>


  <script src="/js/vue-typed-js/index.js"></script>


<!-- 首页的公告滚动插件的js需要重新加载 -->
<script src="/js/vue-seamless-scroll/index.js"></script>

<!-- 打字机效果js -->
<script src="https://unpkg.com/typed.js@2.0.11"></script>


    <div id="safearea">
      <main class="main" id="pjax-container">
        <!-- 头部导航 -->
        
<header class="header  " 
  id="navHeader"
  style="position: fixed;
  left: 0; top: 0; z-index: 10;width: 100%;"
>
  <div class="header-content">
    <div class="bars">
      <div id="appDrawer" class="sidebar-image">
  <div class="drawer-box-icon">
    <i class="fas fa-bars" aria-hidden="true" @click="showDialogDrawer"></i>
  </div>
  
  <transition name="fade">
    <div class="drawer-box_mask" v-cloak style="display: none;" v-show="visible" @click.self="cancelDialogDrawer">
    </div>
  </transition>
  <div class="drawer-box" :class="{'active': visible}">
    <div class="drawer-box-head bg-color">
      <img class="drawer-box-head_logo lazyload placeholder" src="/medias/logo.png" class="lazyload placeholder" data-srcset="/medias/logo.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="logo">
      <h3 class="drawer-box-head_title">Jan&#39;s Blog</h3>
      <h5 class="drawer-box-head_desc">千磨万击还坚劲，任尔东西南北风</h5>
    </div>
    
    <div class="drawer-box-content">
      <ul class="drawer-box-content_menu">
        
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/" class="drawer-menu-item-link">
                  
                    <i class="fas fa-home" aria-hidden="true"></i>
                  
                  <span class="name">首页</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/archives" class="drawer-menu-item-link">
                  
                    <i class="fas fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">归档</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/tags" class="drawer-menu-item-link">
                  
                    <i class="fas fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">标签</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/categories" class="drawer-menu-item-link">
                  
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">分类</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/about" class="drawer-menu-item-link">
                  
                  <span class="name">关于</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/resume" class="drawer-menu-item-link">
                  
                  <span class="name">简历</span>
                </a>
              
            </li>
          
        
        
          <li class="drawer-box-content_item">
            <a target="_blank" rel="noopener" href="https://github.com/Jan-nku/Jan-nku.github.io">
              <i class="fas fa-github" aria-hidden="true"></i>
              <span>Github</span>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDrawer',
    data: {
      visible: false,
      top: 0,
      openArr: [],
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      isOpen(index) {
        if (this.openArr.includes(index)) {
          return true;
        } else {
          return false;
        }
      },
      openOrCloseMenu(curIndex) {
        const index = this.openArr.indexOf(curIndex);
        if (index !== -1) {
          this.openArr.splice(index, 1);
        } else {
          this.openArr.push(curIndex);
        }
      },
      showDialogDrawer() {
        this.visible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'width: 100%; height: 100%;overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      }
    },
    created() {}
  })
</script>

    </div>
    <div class="blog-title" id="author-avatar">
      
        <div class="avatar">
          <img src="/medias/logo.png" class="lazyload placeholder" data-srcset="/medias/logo.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="logo">
        </div>
      
      <a href="/" class="logo">Jan&#39;s Blog</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/" class="menu-item-link" title="首页">
                  
                    <i class="fas fa-home" aria-hidden="true"></i>
                  
                  <span class="name">首页</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/archives" class="menu-item-link" title="归档">
                  
                    <i class="fas fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">归档</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/tags" class="menu-item-link" title="标签">
                  
                    <i class="fas fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">标签</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/categories" class="menu-item-link" title="分类">
                  
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">分类</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/about" class="menu-item-link" title="关于">
                  
                  <span class="name">关于</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/resume" class="menu-item-link" title="简历">
                  
                  <span class="name">简历</span>
                </a>
              
            </li>
          
        
      </ul>
      
      
        <div id="appSearch">
  <div class="search"  @click="showDialog()"><i class="fas fa-search" aria-hidden="true"></i></div>
  <transition name="fade">
    <div class="message-box_wrapper" style="display: none;" v-cloak v-show="dialogVisible" @click.self="cancelDialogVisible()">
      <div class="message-box animated bounceInDown">
        <h2>
          <span>
            <i class="fas fa-search" aria-hidden="true"></i>
            <span class="title">本地搜索</span>
          </span>
          <i class="fas fa-times close" pointer style="float:right;" aria-hidden="true" @click.self="cancelDialogVisible()"></i>
        </h2>
        <form class="site-search-form">
          <input type="text"
            placeholder="请输入关键字"
            id="local-search-input" 
            @click="getSearchFile()"
            class="st-search-input"
            v-model="searchInput"
          />
        </form>
        <div class="result-wrapper">
          <div id="local-search-result" class="local-search-result-cls"></div>
        </div>
      </div>
    </div>
  </transition>
</div>
<script src="/js/local_search.js"></script>
<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appSearch',
    data: {
      dialogVisible: false,
      searchInput: '',
      top: 0,
    },
    computed: {
    },
    mounted() {
      window.addEventListener('pjax:complete', () => {
        this.cancelDialogVisible();
      })
    },
    methods: {
      showDialog() {
        this.dialogVisible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'overflow: hidden;';
      },
      getSearchFile() {
        if (!this.searchInput) {
          getSearchFile("/search.xml");
        }
      },
      cancelDialogVisible() {
        this.dialogVisible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
    },
    created() {}
  })
</script>
<!-- 解决刷新页面闪烁问题，可以在元素上添加display: none, 或者用vue.extend方法，详情：https://blog.csdn.net/qq_31393401/article/details/81017912 -->
<!-- 下面是搜索基本写法 -->
<!-- <script type="text/javascript" id="local.search.active">
  var inputArea = document.querySelector("#local-search-input");
  inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
  inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script> -->

      

    </nav>
  </div>
  
    <a target="_blank" rel="noopener" href="https://github.com/Jan-nku/Jan-nku.github.io" class="github-corner color-primary" aria-label="View source on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  
  
</header>
        <!-- 内容区域 -->
        
 <!-- prismjs 代码高亮 -->
 


<div class="bg-dark-floor" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -1;"></div>


  <!-- 文章详情页顶部图片和标题 -->




<div class="post-detail-header" id="thumbnail_canvas" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;background-image:url('https://picx.zhimg.com/80/v2-b44931ea513e5f7b3b06f2703f79653c_1440w.webp')">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="post-detail-header_info-box">
    <div class="title-box">
      <span class="title">
        sketch调研
      </span>
    </div>
    
    
      
        <span class="post-detail-header_date">
          <i class="fas fa-calendar"></i> 发表于：2023-04-15 |
        </span>
      

      
        <span class="post-detail-header_categories">
          <i class="iconfont iconbookmark1"></i> 分类：
          
            <a href="/categories/sketch/" class="post-detail-header_category">
              sketch
            </a>
          
        </span>
      

      
        <div class="post-detail-header_wordcount">
          <span class="totalcount">
            <i class="fas fa-file-text-o"></i> 字数统计: 5.6k |
          </span>
  
          <span class="min2read">
            <i class="fas fa-clock"></i> 阅读时长: 29分钟 |
          </span>
  
          
            <span class="reading">
              <i class="fas fa-eye"></i> 阅读量：<span id="busuanzi_value_page_pv"></span>
            </span>
          
        </div>
      
    
  </div>
  
  
    <script src="/js/bubble/bubble.js"></script>
  
</div>





<div class="post-detail-content post-row" 
  style="padding-top: 0px;">
  <div class="main-content">
    <article class="post post-detail">
      <div class="post-content">
        <h1 id="Sketch调研"><a href="#Sketch调研" class="headerlink" title="Sketch调研"></a>Sketch调研</h1><h2 id="Measurement-Tasks"><a href="#Measurement-Tasks" class="headerlink" title="Measurement Tasks"></a>Measurement Tasks</h2><p><img src="/image-20230415145237712.png" class="lazyload placeholder" data-srcset="/image-20230415145237712.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h3 id="Data-Stream-Network-Traffic"><a href="#Data-Stream-Network-Traffic" class="headerlink" title="Data Stream/Network Traffic"></a>Data Stream/Network Traffic</h3><p><img src="/image-20230416095726509.png" class="lazyload placeholder" data-srcset="/image-20230416095726509.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h3 id="Measurement-Tasks-1"><a href="#Measurement-Tasks-1" class="headerlink" title="Measurement Tasks"></a>Measurement Tasks</h3><p><img src="/image-20230416095704004.png" class="lazyload placeholder" data-srcset="/image-20230416095704004.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h2 id="Sketch-Algorithms"><a href="#Sketch-Algorithms" class="headerlink" title="Sketch Algorithms"></a>Sketch Algorithms</h2><h3 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h3><p>sketch 是一种基于散列的数据结构，可以在高速网络环境中，实时地存储流量特征信息，只占用较小的空间资源，并且具备在理论上可证明的估计精度与内存的平衡特性。</p>
<blockquote>
<p>所谓 sketch 就是用很少的一点数据来描述全体数据的特性，牺牲了准确性但是代价变得很低。sketch解决网络测量任务中的一种或几种。</p>
</blockquote>
<p>设计目标：</p>
<ul>
<li>Memory Usage(MB, around 1MB)</li>
<li>Speed(80Mpps/3.2Tbps)</li>
<li>Accuracy(ARE：平均相对误差, AAE：平均绝对误差, Precision, Recall, F1 score)</li>
<li>Generic</li>
<li>Elastic(bandwidth, packet rate, flow size distribution)</li>
<li>Cross-platform(Hardware friendly)</li>
</ul>
<blockquote>
<p>名词解释：</p>
<p>ARE和AAE都是用于衡量估计值与真实值之间误差的指标。 </p>
<p>ARE全称为Average Relative Error，即平均相对误差。它表示估计值与真实值之间的相对误差的平均值。ARE是一个无量纲的指标，通常用百分数表示。具体而言，ARE的计算公式为：ARE = (1/n) * ∑(|e_i| / v_i)，其中n表示样本数量，e_i表示估计值与真实值之间的误差，v_i表示真实值。 </p>
<p>AAE全称为Average Absolute Error，即平均绝对误差。它表示估计值与真实值之间的绝对误差的平均值。与ARE不同，AAE是一个有量纲的指标，其单位与估计值和真实值的单位相同。具体而言，AAE的计算公式为：AAE = (1/n) * ∑(|e_i|)，其中n表示样本数量，e_i表示估计值与真实值之间的误差。 通常情况下，ARE和AAE越小，表示估计值与真实值之间的误差越小，估计结果越准确。因此，在进行估计算法的评价时，ARE和AAE是常用的评价指标之一。</p>
<p><img src="/image-20230415171900978.png" class="lazyload placeholder" data-srcset="/image-20230415171900978.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415171814065.png" class="lazyload placeholder" data-srcset="/image-20230415171814065.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415171605698.png" class="lazyload placeholder" data-srcset="/image-20230415171605698.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415171709827.png" class="lazyload placeholder" data-srcset="/image-20230415171709827.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
</blockquote>
<h3 id="比较早的Sketch"><a href="#比较早的Sketch" class="headerlink" title="比较早的Sketch"></a>比较早的Sketch</h3><blockquote>
<p>Problem：Given a multiset, how many times did an item appears?</p>
</blockquote>
<h4 id="Count-Min-Sketch"><a href="#Count-Min-Sketch" class="headerlink" title="Count-Min Sketch"></a>Count-Min Sketch</h4><p><img src="/image-20230415152707870.png" class="lazyload placeholder" data-srcset="/image-20230415152707870.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415152720367.png" class="lazyload placeholder" data-srcset="/image-20230415152720367.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415152757919.png" class="lazyload placeholder" data-srcset="/image-20230415152757919.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<blockquote>
<p><em>论文：Cormode, Graham, and Shan Muthukrishnan. “An improved data stream summary: the count-min sketch and its applications.” Journal of Algorithms 55.1 (2005): 58-75.</em></p>
</blockquote>
<h4 id="CU-Sketch"><a href="#CU-Sketch" class="headerlink" title="CU Sketch"></a>CU Sketch</h4><p>CU Sketch 只是对于CM 进行了微小的改动，即变成了“<strong>保守更新</strong>”。在更新的时候，把之前对于每个counter进行加法的操作变成了只对于最小的counter做+1，这样显然正确性还可以保证，并且大幅提升了准确度，但显然就失去了对于删除操作的支持。(当然在网络领域并不关心删除操作)</p>
<p><img src="/image-20230415155127540.png" class="lazyload placeholder" data-srcset="/image-20230415155127540.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<blockquote>
<p><em>论文：- C. Estan and G. Varghese. New directions in traffic measurement and accounting: Focusing on the elephants, ignoring the mice. ACM Transactions on Computer Systems (TOCS), 21(3):270–313, 2003.</em></p>
</blockquote>
<h4 id="Count-Sketch-unbiased"><a href="#Count-Sketch-unbiased" class="headerlink" title="Count Sketch (unbiased)"></a>Count Sketch (unbiased)</h4><p><img src="/image-20230415154341736.png" class="lazyload placeholder" data-srcset="/image-20230415154341736.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415154946343.png" class="lazyload placeholder" data-srcset="/image-20230415154946343.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415154921006.png" class="lazyload placeholder" data-srcset="/image-20230415154921006.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><font color="red">有机会可以看一看数学推导，感觉很神奇</font></p>
<blockquote>
<p><em>论文：M. Charikar, K. Chen, and M. Farach-Colton. Finding frequent items in data streams. Automata, languages and programming, pages 784–784, 2002.</em></p>
</blockquote>
<h4 id="CMM-Sketch-unbiased"><a href="#CMM-Sketch-unbiased" class="headerlink" title="CMM Sketch  (unbiased)"></a>CMM Sketch  (unbiased)</h4><p><img src="/image-20230415155837537.png" class="lazyload placeholder" data-srcset="/image-20230415155837537.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415162130491.png" class="lazyload placeholder" data-srcset="/image-20230415162130491.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><font color="red">论文原文中提到如何消除噪声，杨老师视频中（好像）说只能取平均值，中位数推导不出无偏，我看原文写的是取中位数，等以后有时间看看数学推导</font></p>
<blockquote>
<p><em>论文：Deng F, Rafiei D. New estimation algorithms for streaming data: Count-min can do more[J]. Webdocs. Cs. Ualberta. Ca, 2007.</em></p>
</blockquote>
<h4 id="Randomized-CM-Sketch"><a href="#Randomized-CM-Sketch" class="headerlink" title="Randomized CM Sketch"></a>Randomized CM Sketch</h4><p><img src="/image-20230415162650406.png" class="lazyload placeholder" data-srcset="/image-20230415162650406.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>本文提出了一种新的流量测量算法，称为随机计数器共享(Randomized Counter Sharing，RCS)。</p>
<p>该算法通过将流量分类到一组随机选择的计数器上，来估计每个流的流量。RCS算法的主要思想是将每个数据包映射到多个计数器上，然后将这些计数器的值进行加权平均，得到该流的流量估计值。</p>
<p> 与传统的计数器共享算法不同的是，RCS算法对计数器的选择采用了随机化的技术，使得每个流的数据包被映射到的计数器是随机的，并且不同流的数据包可能被映射到相同的计数器上。这种随机化的技术可以有效地减小计数器之间的竞争，并提高流量估计的准确性。</p>
<blockquote>
<p>论文：<em>T. Li, S. Chen, and Y. Ling. Per-flow traffic measurement through randomized counter sharing. IEEE/ACM Transactions on Networking (TON), 20(5):1622–1634, 2012</em></p>
</blockquote>
<h4 id="Augmented-sketch-Sigmod’16"><a href="#Augmented-sketch-Sigmod’16" class="headerlink" title="Augmented sketch(Sigmod’16)"></a>Augmented sketch(Sigmod’16)</h4><p>Asketch的思想在于增加了一个过滤器，可与原先的sketch进行元素交换(exchange)。过滤器中的每个元素都有new_count和old_count两个值，new_count保持对数据项的过高估计(如同原先的sketch)，而new_count和old_count间的差值表示在某段时间内该数据项的累计值。</p>
<p><img src="/image-20230416101428566.png" class="lazyload placeholder" data-srcset="/image-20230416101428566.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>对二元组(k,u)进行插入操作，k为元素，u为次数：</p>
<ol>
<li><p>如果过滤器中有k，直接对其new_count加u，而old_count不变</p>
</li>
<li><p>如果没有且过滤器未满，把k加入并设其new_count = u, old_count =0</p>
</li>
<li><p>如果没有且过滤器已满，先把k加入sketch，若此时对k的估计值大于过滤器中的最小值，则将该最小值散列到sketch中共(new_count - old_count)次，并把k加入过滤器，new_count和old_count都设为原先k的估计值。</p>
</li>
</ol>
<p>对于查询操作较为简单：即现在过滤器中查询，有则返回其new_count值，否则到sketch中进行估计。</p>
<p><img src="/image-20230415190728149.png" class="lazyload placeholder" data-srcset="/image-20230415190728149.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230415191109610.png" class="lazyload placeholder" data-srcset="/image-20230415191109610.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><font color="red">Asketch的优点在于节省了很多次的hash计算，因为部分元素聚集在过滤器中。且因为高频项大部分时间都存在过滤器中，而过滤器的计数是完全精确的，因此可以大大提高对高频项的估计情况。</font></p>
<blockquote>
<p>论文：<em>Roy P, Khan A, Alonso G. Augmented sketch: Faster and more accurate stream processing[C]//Proceedings of the 2016 International Conference on Management of Data. 2016: 1449-1463.</em></p>
</blockquote>
<h4 id="FM-Sketch"><a href="#FM-Sketch" class="headerlink" title="FM Sketch"></a>FM Sketch</h4><p>论文笔记：<a target="_blank" rel="noopener" href="https://blog.csdn.net/wbin233/article/details/78730977">https://blog.csdn.net/wbin233/article/details/78730977</a></p>
<blockquote>
<p>论文：<em>Flajolet, Philippe, and G. Nigel Martin. “Probabilistic counting algorithms for data base applications.”</em> <em>Journal of computer and system sciences</em> <em>31.2 (1985): 182-209.</em></p>
</blockquote>
<h3 id="复杂一些的Sketch"><a href="#复杂一些的Sketch" class="headerlink" title="复杂一些的Sketch"></a>复杂一些的Sketch</h3><blockquote>
<p>复杂一些的Sketch一般会用到网络流的特性</p>
<p>复杂的Sketch会单独放在论文精读系列，这里仅仅列出重要思想</p>
</blockquote>
<h4 id="Pyramid-Sketch-VLDB’17"><a href="#Pyramid-Sketch-VLDB’17" class="headerlink" title="Pyramid Sketch (VLDB’17)"></a>Pyramid Sketch (VLDB’17)</h4><ul>
<li>Counter-pair Sharing</li>
</ul>
<p><img src="/image-20230415163218609.png" class="lazyload placeholder" data-srcset="/image-20230415163218609.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230416100010391.png" class="lazyload placeholder" data-srcset="/image-20230416100010391.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230416100857700.png" class="lazyload placeholder" data-srcset="/image-20230416100857700.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<ul>
<li><p>Word Acceleration</p>
<ul>
<li>Word Constraint Technique</li>
</ul>
<blockquote>
<p>论文原文：</p>
<p>On top of the Pyramid sketch with only counter-pair sharing, adding the technique of word constraint helps reduce memory accesses per insertion or query, but incurs severe accuracy loss in the meantime.The main reason for accuracy loss is that after implementing the carryin operation, the probability of collision among counters in the same machine word increases sharply at higher layers. More specifically, given an item e, its d counters at layer L1 are mapped to one machine word, while the parent counters of these d counters are mapped to half of a word at layer L2. The ancestor counters are mapped to even small ranges in a word at higher layers, resulting in more collisions.</p>
</blockquote>
<ul>
<li>Word Sharing Technique</li>
</ul>
<p><img src="/image-20230416100439184.png" class="lazyload placeholder" data-srcset="/image-20230416100439184.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<ul>
<li>One Hashing Technique</li>
</ul>
<blockquote>
<p>论文原文：The idea is to split the value that a hash function produces into several segments, and each segment is used to locate a word or a counter, so as to reduce the hash computation.</p>
</blockquote>
</li>
<li><p>Ostrich Policy(Only CU Sketch is supported)</p>
</li>
</ul>
<blockquote>
<p>The key idea of Ostrich policy is ignoring the second and higher layers when getting the reported values of the d mapped counters.</p>
</blockquote>
<p><img src="/image-20230416101327292.png" class="lazyload placeholder" data-srcset="/image-20230416101327292.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230416101249473.png" class="lazyload placeholder" data-srcset="/image-20230416101249473.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/zhouyangpkuer/Pyramid_Sketch_Framework">zhouyangpkuer/Pyramid_Sketch_Framework: This repository contains the open source of the Pyramid sketch framework (accepted by VLDB 2017 and then submitted to ToN). (github.com)</a></p>
<blockquote>
<p>论文：<em>T. Yang, Y. Zhou, H. Jin, S. Chen, and X. Li. Pyramid sketch: a sketch framework for frequency estimation of data streams. Proceedings of the VLDB Endowment, 10(11):1442–1453, 2017.</em></p>
</blockquote>
<h4 id="SpaceSaving"><a href="#SpaceSaving" class="headerlink" title="SpaceSaving"></a>SpaceSaving</h4><blockquote>
<p>top-k问题</p>
<p>Misra-Gries算法（1982）</p>
<p><img src="/image-20230416111019574.png" class="lazyload placeholder" data-srcset="/image-20230416111019574.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>Lossy Counting算法（2002）</p>
<p><img src="/image-20230416113441536.png" class="lazyload placeholder" data-srcset="/image-20230416113441536.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230416113529606.png" class="lazyload placeholder" data-srcset="/image-20230416113529606.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230416113545467.png" class="lazyload placeholder" data-srcset="/image-20230416113545467.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230416113602819.png" class="lazyload placeholder" data-srcset="/image-20230416113602819.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
</blockquote>
<p><img src="/image-20230416113728399.png" class="lazyload placeholder" data-srcset="/image-20230416113728399.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>如果元素在集合中，将其对应的计数器自增；</p>
<p>如果元素不在集合中且集合未满，就将元素加入集合，计数器设为1；</p>
<p><strong>如果元素不在集合中且集合已满，将集合内计数器值最小的元素移除，将新元素插入到它的位置，并且在原计数值的基础上自增</strong>。（这里维护计数值最小的元素可以用传统的堆）</p>
<p><img src="/image-20230416114037743.png" class="lazyload placeholder" data-srcset="/image-20230416114037743.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<blockquote>
<p>sketch+堆在top-k问题中优化空间有限，建议使用hash table</p>
<p>SpaceSaving算法理论推的很好，实验效果一般，堆复杂度O(logn)不能忍受</p>
</blockquote>
<p><img src="/image-20230422183835875.png" class="lazyload placeholder" data-srcset="/image-20230422183835875.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230422183835875"></p>
<blockquote>
<p>论文：</p>
<p><em>1.A. Metwally, D. Agrawal, and A. El Abbadi. Efficient computation of frequent and top-k elements in data streams. In Proc. Springer ICDT, 2005.</em><br><em>2.Ting D. Data Sketches for Disaggregated Subset Sum and Frequent Item Estimation[C]//Proceedings of the 2018 International Conference on Management of Data. ACM, 2018: 1129-1140.</em></p>
</blockquote>
<h4 id="LTC-ICDE’19-Significant-Items"><a href="#LTC-ICDE’19-Significant-Items" class="headerlink" title="LTC (ICDE’19) Significant Items"></a>LTC (ICDE’19) Significant Items</h4><h5 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h5><blockquote>
<p>top-k问题，改进spacesaving</p>
<p>frequent + persistent</p>
</blockquote>
<p><img src="/image-20230422190656401.png" class="lazyload placeholder" data-srcset="/image-20230422190656401.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230422190656401"></p>
<p>User cases: DDoS attacks detection、Website evaluation、Network congestion</p>
<h5 id="related-work"><a href="#related-work" class="headerlink" title="related work"></a>related work</h5><p><img src="/image-20230422191204736.png" class="lazyload placeholder" data-srcset="/image-20230422191204736.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>To the best of our knowledge, no prior work could deal with finding significant items. A straightforward solution is to combine two data structures: one for finding frequent items and the other for finding persistent items.</p>
<p>Existing algorithms for finding frequent items could be divided into two categories: sketch-based and counter-based. The sketch-based category includes the CM sketch and the CU sketch. The counter-based category includes CSS, Space Saving, and Lossy Counting. </p>
<p>For finding persistent items, the key problem is that the estimated persistency of an item should be incremented at most 1 even if it appeared several times in a period. So, the straightforward solution is to use a counting bloom filter to judge whether this item has appeared before in the current period and use a sketch-based data structure to record its estimated persistency.In VLDB 2017, the algorithm PIE was proposed, it uses T data structures to record information, where T is the number of periods.</p>
<p>However, all the existing data structures have the following limitations: they are low memory efficient. As a result, they are inaccurate in the situation of tight memory size.</p>
<h5 id="Long-tail-Clock-LTC"><a href="#Long-tail-Clock-LTC" class="headerlink" title="Long-tail Clock (LTC)"></a>Long-tail Clock (LTC)</h5><h6 id="LTC—Data-structure"><a href="#LTC—Data-structure" class="headerlink" title="LTC—Data structure"></a>LTC—Data structure</h6><p>First we present our data structure. It is a lossy table, consists of w buckets. Every bucket consists of d cells. And every cell consists of three fields: ID, frequency and persistency. The persistency fields consists of two parts: a counter and a flag.</p>
<p>The ID filed records an item’s ID, the frequency field records the estimated frequency of that item. the counter part records the estimated persistency of that item, and the flag denotes whether this item has appeared in the current period. Using these fields, we can easily calculate the estimated significance of recorded items. When an item arrives, first it will be mapped to a bucket by a hash function.</p>
<p><img src="/image-20230422191745510.png" class="lazyload placeholder" data-srcset="/image-20230422191745510.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="LTC—Insertion-update-frequency"><a href="#LTC—Insertion-update-frequency" class="headerlink" title="LTC—Insertion (update frequency)"></a>LTC—Insertion (update frequency)</h6><blockquote>
<p>Difficulty: how to insert an item e when the mapped bucket is full.</p>
</blockquote>
<p>Note the situation we discuss is the memory size is tight. So we can’t record all items’ information. So when an item is mapped to a bucket. There are three cases.</p>
<p>First, it could be found in that bucket. Apparently, we just need to increment the estimated frequency by 1.</p>
<p>Second, we can’t find it in that bucket but there is an empty cell. Easily, we just need to set the estimated frequency to 1.</p>
<p>The difficult point is the third situation: we can’t find it in that bucket and the mapped bucket is full. Discarding this item is not a good choice. </p>
<p>Here is our solution: in the mapped bucket, we first find a recorded item with the smallest estimated significance. and then we decrement the estimated frequency of this item by 1. If the estimated significance of that item is 0, we replace it with the arriving item. In this way, for any time, the arriving item has a chance to be inserted into our data structure.</p>
<p><img src="/image-20230422192909187.png" class="lazyload placeholder" data-srcset="/image-20230422192909187.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="LTC—Insertion-update-persistency"><a href="#LTC—Insertion-update-persistency" class="headerlink" title="LTC—Insertion (update persistency)"></a>LTC—Insertion (update persistency)</h6><blockquote>
<p>Difficulty: how to update the counter</p>
<p>Solution: using Clock</p>
</blockquote>
<p><strong>The strategy of updating persistency in the third case is similar: decrementing the most insignificant item’s estimated persistency by 1. And if the estimated significance of that item is 0, we replace it with the arriving item.</strong></p>
<p>However, the difficult point of updating persistency is that during one period, we can only increment the counter of an item at most 1 even if it appeared several times. To deal with this problem, we leverage the spirit of a well-known algorithm: Clock.</p>
<p><img src="/image-20230422193320961.png" class="lazyload placeholder" data-srcset="/image-20230422193320961.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230422193320961"></p>
<p>As shown in the slide, every cell corresponds to a time slot in the Clock. A pointer p moves clockwise and passes several slots for every insertion. The time of passing all slots is equal to the length of that period. To guarantee it, we just need to set the speed of p appropriately. when an item arrives, if we find it in a cell, we just set the flag to true, which denotes this item has appeared in the current period. Furthermore, we use another thread to scan all time slots which are passed by the pointer p, and update the corresponding cells’ counter: <strong>if the flag is true, we increment its counter and reset the flag to false, otherwise we do nothing.</strong> In this way, it is guaranteed that every counter is incremented at most once in a period, since its corresponding time slot is scanned exactly once in one period.</p>
<h6 id="LTC—Query"><a href="#LTC—Query" class="headerlink" title="LTC—Query"></a>LTC—Query</h6><p><img src="/image-20230422193923806.png" class="lazyload placeholder" data-srcset="/image-20230422193923806.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Optimizations"><a href="#Optimizations" class="headerlink" title="Optimizations"></a>Optimizations</h5><h6 id="Optimizations—Long-tail-Replacement"><a href="#Optimizations—Long-tail-Replacement" class="headerlink" title="Optimizations—Long-tail Replacement"></a>Optimizations—Long-tail Replacement</h6><blockquote>
<p>Assumption: Real datasets often follow the long-tail distribution, and frequencies of items that fall into the same bucket still follow long-tail distribution.</p>
</blockquote>
<p>Next we present the strategy of long-tail replacement.</p>
<p>Here is the main problem: how to set the initial value of the newly inserted item?</p>
<p>When a new item in inserted into some cell, it seems that this item arrives for the first time, so the  initial values should be set to 1. However, its real frequency and persistency tend to be much larger than 1, because it may have come many times to offset the original smallest item in that bucket. </p>
<p>To address this problem, we propose an optimization namely Long-tail replacement. Thanks to the long-tail distribution, we can consider that the smallest value is close to the second smallest value. So we set the initial value to the second smallest value minus 1. In the worst case, an infrequent of inpersistent item is inserted into that cell, but the initial value is very large. However, with a high probability it will be expelled soon, since it seldom appears later.</p>
<p><img src="/image-20230422194408317.png" class="lazyload placeholder" data-srcset="/image-20230422194408317.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="Optimizations—Deviation-Eliminator"><a href="#Optimizations—Deviation-Eliminator" class="headerlink" title="Optimizations—Deviation Eliminator"></a>Optimizations—Deviation Eliminator</h6><p>As shown in this slide, for an item, if it arrived at time Ta and Tb, but the corresponding time slot was scanned at time Ta’ and Tb’, the counter would be incremented twice. The reason behind is that this time slot has a deviation from the real period.</p>
<p>Here is our solution, we replace the flag with two flags: the current flag denotes whether the recorded item has appeared in the current period, and the previous flag denotes whether the recorded item has appeared in the previous period.</p>
<p>When an item arrives, we update the current flag, when a time slot is scanned, we use the previous flag of the corresponding cell to update the counter. In this way, the deviation is eliminated. </p>
<p><img src="/image-20230422195000922.png" class="lazyload placeholder" data-srcset="/image-20230422195000922.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h5><p>We first conduct experiments to compare our algorithm with related works for finding frequent items. Our algorithm works by setting alpha to 1 and beta to 0. The red curve in this slide denotes our algoirithm .The results show that the performance our algorithm is much better than others.</p>
<p><img src="/image-20230422195457254.png" class="lazyload placeholder" data-srcset="/image-20230422195457254.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>We also conduct experiments to compare related works for finding persistent items. Similarly, our algorithm works by setting alpha to 0 and beta to 1. The results also show that the performance our algorithm is much better than others.</p>
<p><img src="/image-20230422195525369.png" class="lazyload placeholder" data-srcset="/image-20230422195525369.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>Finally, we conduct experiments to compare related works for finding significant items. The baselines are the CM sketch and the CU sketch. As I said before, for sketches, we use a counting bloom filter to make sure every item contributes at most 1 in one period. As shown in the slide, the first number denotes alpha, and the second number denotes beta. We can also observe that the performance of our algorithm is much better than sketches.</p>
<p><img src="/image-20230422195548458.png" class="lazyload placeholder" data-srcset="/image-20230422195548458.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/Finding-Significant-Items/Finding-Significant-Items">https://github.com/Finding-Significant-Items/Finding-Significant-Items</a></p>
<blockquote>
<p>论文：<em>Tong Yang, Haowei Zhang, Dongsheng Yang, Yucheng Huang, Xiaoming Li. Finding Significant Items in Data Streams. IEEE ICDE 2019.</em> </p>
</blockquote>
<h4 id="HeavyGuardian-SIGKDD’18"><a href="#HeavyGuardian-SIGKDD’18" class="headerlink" title="HeavyGuardian (SIGKDD’18)"></a>HeavyGuardian (SIGKDD’18)</h4><p><img src="/image-20230422202128017.png" class="lazyload placeholder" data-srcset="/image-20230422202128017.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230422202823432.png" class="lazyload placeholder" data-srcset="/image-20230422202823432.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><font color="red">先理解算法思路，以后有时间再看</font></p>
<p>论文笔记：[(95条消息) <a target="_blank" rel="noopener" href="https://blog.csdn.net/iroy33/article/details/103216621/">论文笔记] SIGKDD HeavyGuardian: Separate and Guard Hot Items in Data Streams_iroy33的博客-CSDN博客</a></p>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/Gavindeed/HeavyGuardian">Gavindeed/HeavyGuardian (github.com)</a></p>
<blockquote>
<p>论文：<em>Yang T, Gong J, Zhang H, et al. Heavyguardian: Separate and guard hot items in data streams[C]//Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining. ACM, 2018: 2584-2593.</em></p>
</blockquote>
<h4 id="Elastic-Sketch-SIGCOMM’18"><a href="#Elastic-Sketch-SIGCOMM’18" class="headerlink" title="Elastic Sketch (SIGCOMM’18)"></a>Elastic Sketch (SIGCOMM’18)</h4><h5 id="Background-1"><a href="#Background-1" class="headerlink" title="Background"></a>Background</h5><p>Measurement is important, Network measurement provides indispensable information for network applications. </p>
<p>Best solution: Sketch (Memory efficient、Constant speed、High accuracy)</p>
<p>Existing measurement solutions  mainly focus on a good trade-off among accuracy, speed and memory usage. The state-of-the-art <strong>UnivMon</strong> pays attention to an additional aspect, generality, namely using one sketch to process many tasks, and makes a good trade-off among these four dimensions.</p>
<p>In additional to the above four dimensions, we pay attention to another two aspects: <strong>adaptive to traffic characteristics and cross platform</strong>. Measurements are especially important when network is undergoing problems, such as: network congestion, scans and DDoS attack. In these cases, traffic characteristics vary a lot.traffic characteristics vary drastically, significantly degrading the measurement performance. Therefore, it is desirable to achieve accurate network measurements when traffic characteristics vary a lot.</p>
<p><strong>adaptive to traffic characteristics</strong></p>
<p>The first traffic characteristic is the available bandwidth. In data centers, administrators care more about the state of the whole network than a single link or node, known as network-wide measurements. For this, they often deploy many measurement nodes, which periodically report sketches to a collector. However, network congestion is common, and the available bandwidth is unstable.</p>
<p><img src="/image-20230422205515541.png" class="lazyload placeholder" data-srcset="/image-20230422205515541.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>The packet rate is naturally variable and could vary drastically. The processing speed of existing sketches on software platforms is fixed in terms of packet rate.</p>
<p><img src="/image-20230422205940176.png" class="lazyload placeholder" data-srcset="/image-20230422205940176.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>flow size distribution</p>
<p><img src="/image-20230422210203209.png" class="lazyload placeholder" data-srcset="/image-20230422210203209.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><strong>Cross platform</strong></p>
<p>Most existing solutions are designed for a specific platform. Our goal is to achieve that the designed sketches can be implemented on six platforms. Including …</p>
<p><img src="/image-20230422210338080.png" class="lazyload placeholder" data-srcset="/image-20230422210338080.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<table>
<thead>
<tr>
<th><strong>Tasks</strong></th>
<th><strong>Sketch</strong> <strong>Algorithms</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Flow size estimation</td>
<td>Count-Min, CM-CU, Count, ASketch</td>
</tr>
<tr>
<td>heavyhitters</td>
<td>Count-Min, CM-CU, Space-SavingHashpipe, ASketch, FlowRadar, UnivMon</td>
</tr>
<tr>
<td>Heavy changes</td>
<td>RevSketch, FlowRadar, UnivMon</td>
</tr>
<tr>
<td>Superspreader/DDoS detection</td>
<td>TwoLevel</td>
</tr>
<tr>
<td>Flow size distribution</td>
<td>MRAC, FlowRadar</td>
</tr>
<tr>
<td>Cardinality</td>
<td>FM, LC, UnivMon</td>
</tr>
<tr>
<td>Entropy</td>
<td>FlowRadar, UnivMon</td>
</tr>
</tbody></table>
<h5 id="Elastic-Sketches"><a href="#Elastic-Sketches" class="headerlink" title="Elastic Sketches"></a>Elastic Sketches</h5><h6 id="Rationale"><a href="#Rationale" class="headerlink" title="Rationale"></a>Rationale</h6><p>Ostracism(vote for elephant flows)</p>
<p><img src="/image-20230422211607387.png" class="lazyload placeholder" data-srcset="/image-20230422211607387.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230422211747825.png" class="lazyload placeholder" data-srcset="/image-20230422211747825.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230422211910787.png" class="lazyload placeholder" data-srcset="/image-20230422211910787.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="Adaptivity"><a href="#Adaptivity" class="headerlink" title="Adaptivity"></a>Adaptivity</h6><ol>
<li>Adaptive to Available Bandwidth</li>
</ol>
<p><img src="/image-20230422213036204.png" class="lazyload placeholder" data-srcset="/image-20230422213036204.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>Here we use an example to show the compression algorithm. We have a sketch with width of 9, and suppose we want to compress its width to 3. There are three steps:</p>
<p>first, we split the sketch A into three divisions equally<br>We build a sketch B with width of 3.<br>We consider the counters with the same index as one group.</p>
<p>For counters in one group, we have two method to compress them: using the sum value or the max value. If we use the max, the accuracy can be improved a lot. Then we show how the hash functions change? We give two simple example: </p>
<p>And therefore, the hash function is changed from h()%9 to h()%3, therefore, our compression does not need any additional data strucutres. What’s more, we do not need decompression.</p>
<p><img src="/image-20230422213553601.png" class="lazyload placeholder" data-srcset="/image-20230422213553601.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>Then, we can also merge sketches. Here we show how to merge two sketches with the same hash functions and same size. Similarly, the counters with the same index are regarded as one group. For counters in one group, we compress them into one. Similarly again, we can use the sum value or the max value.  And using max value can achieve much higher accuracy.</p>
<p><img src="/image-20230422214003198.png" class="lazyload placeholder" data-srcset="/image-20230422214003198.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<ol start="2">
<li>Adaptive to Packet Rate</li>
</ol>
<p><img src="/image-20230422214253524.png" class="lazyload placeholder" data-srcset="/image-20230422214253524.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<ol start="3">
<li>Adaptive to Flow Size Distribution</li>
</ol>
<p><img src="/image-20230422214502628.png" class="lazyload placeholder" data-srcset="/image-20230422214502628.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>For example, as shown in this figure, we just copy the heavy part. After the copy operation, each flow has a redundant copy. A straightforward solution is to eliminate the redundancy by scanning all buckets.</p>
<p>We propose a <strong>lazy elimination</strong>. For example, a flow f2 is mapped to this bucket, we check whether f3 is a redundancy. After computing the hash function, we find it is a redundancy, and we delete f3 and insert flow f2. Similar, the hash function is changed from h(.)%4 to h(.)%8.</p>
<p><img src="/image-20230422214901702.png" class="lazyload placeholder" data-srcset="/image-20230422214901702.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Optimizations-1"><a href="#Optimizations-1" class="headerlink" title="Optimizations"></a>Optimizations</h5><p>To minimize the elephant collision rate</p>
<h6 id="Software-Version"><a href="#Software-Version" class="headerlink" title="Software Version"></a>Software Version</h6><p><img src="/image-20230422215429881.png" class="lazyload placeholder" data-srcset="/image-20230422215429881.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="Hardware-Version"><a href="#Hardware-Version" class="headerlink" title="Hardware Version"></a>Hardware Version</h6><p><img src="/image-20230422215623006.png" class="lazyload placeholder" data-srcset="/image-20230422215623006.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="P4Switch-Version"><a href="#P4Switch-Version" class="headerlink" title="P4Switch Version"></a>P4Switch Version</h6><p><img src="/image-20230422215839463.png" class="lazyload placeholder" data-srcset="/image-20230422215839463.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="Multi-Core-Version"><a href="#Multi-Core-Version" class="headerlink" title="Multi-Core Version"></a>Multi-Core Version</h6><p>For each CPU core, we use one thread. For each thread, we build one sketch. When all sketches are built completely, we merge them to one. Similarly, for counters with the same index, we use the max value to achieve high accuracy.</p>
<p><img src="/image-20230422220014052.png" class="lazyload placeholder" data-srcset="/image-20230422220014052.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Applications"><a href="#Applications" class="headerlink" title="Applications"></a>Applications</h5><ol>
<li>Flow size estimation</li>
<li>Heavy Hitter detection</li>
<li>Heavy Change detection</li>
<li>Flow Size Distribution</li>
<li>Entropy</li>
<li>Cardinality</li>
</ol>
<h5 id="Implementations"><a href="#Implementations" class="headerlink" title="Implementations"></a>Implementations</h5><ol>
<li>P4Switch</li>
<li>FPGA</li>
<li>GPU</li>
<li>CPU</li>
<li>multi-core</li>
<li>OVS</li>
</ol>
<h5 id="Experimental-Results-Summary"><a href="#Experimental-Results-Summary" class="headerlink" title="Experimental Results Summary"></a>Experimental Results Summary</h5><p><img src="/image-20230422220851298.png" class="lazyload placeholder" data-srcset="/image-20230422220851298.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="conclusion"><a href="#conclusion" class="headerlink" title="conclusion"></a>conclusion</h5><p><img src="/image-20230422220312777.png" class="lazyload placeholder" data-srcset="/image-20230422220312777.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>论文笔记：[(95条消息) <a target="_blank" rel="noopener" href="https://blog.csdn.net/iroy33/article/details/103253116?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.highlightwordscore&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.highlightwordscore">论文笔记] Sigcomm 2018 Elastic Sketch: Adaptive and Fast Network-wide Measurements_elastic sketch 阅读_iroy33的博客-CSDN博客</a></p>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/BlockLiu/ElasticSketchCode">BlockLiu/ElasticSketchCode (github.com)</a></p>
<blockquote>
<p>论文：<em>Yang T, Jiang J, Liu P, et al. Elastic sketch: Adaptive and fast network-wide measurements. ACM SIGCOMM 18</em></p>
</blockquote>
<h4 id="Cold-Filter-SIGMOD-18"><a href="#Cold-Filter-SIGMOD-18" class="headerlink" title="Cold Filter (SIGMOD 18)"></a>Cold Filter (SIGMOD 18)</h4><p><img src="/image-20230422223224644.png" class="lazyload placeholder" data-srcset="/image-20230422223224644.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>CF的基本思路就是一个两层的设计，其中L1记录大部分数据访问统计，这部分使用一个较少的bit作为计数的单元。而未来处理一些热点的数据，在计数值超过了L1能够计数的范围之后，将其计数到L2中。</p>
<p>在CF中，一个更新操作的处理流程如下：使用hash函数产生多个hash值，利用这些hash值在L1中找到对应的位置，如果其中的最小值小于L1计数的范围。那么这个时候直接更新最小值。如果存在多个最小值，则更新全部的最小值。如果L1已经超出了计数的范围，则在L2执行同样的的操作。</p>
<p>同理，在执行report操作的时候，也要考虑L1和L2的情况，使用hash函数产生多个hash值，利用这些hash值在L1中找到对应的位置，如果其中的最小值小于L1计数的范围，则报告这个值。如果超过了L1的计数范围，则以同样的方式查找L2，如果L2的计数没有超过，则报告L1和L2的和。<em>如果两个地方都超出了，则很难判断这里的具体情况，这里就直接选择超出了指定的阈值。</em></p>
<p><strong>Update process of CF</strong></p>
<p><img src="/image-20230422224301238.png" class="lazyload placeholder" data-srcset="/image-20230422224301238.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><strong>Report process of CF</strong></p>
<p><img src="/image-20230422224654833.png" class="lazyload placeholder" data-srcset="/image-20230422224654833.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>如果将L1的bit数置为1的话，就类似于一个Bloom Filter结构，在经过这个Bloom Filter过滤之后在L2中的Sketch中计数，从而节省空间，这个思路被用到了TinyLFU中。实现在Java的本地缓存库Caffeine中。</p>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/zhouyangpkuer/ColdFilter">zhouyangpkuer/ColdFilter: This repository contains the open source related to Cold Filter meta-framework (accepted by SIGMOD2018). (github.com)</a></p>
<blockquote>
<p>论文：<em>Zhou Y, Yang T, Jiang J, et al. Cold filter: A meta-framework for faster and more accurate stream processing[C]. Proceedings of the 2018 International Conference on Management of Data. ACM, 2018: 741-756.</em></p>
</blockquote>
<h3 id="Recent-Directions"><a href="#Recent-Directions" class="headerlink" title="Recent Directions"></a>Recent Directions</h3><h4 id="Unbiased-Space-Saving-SIGMOD’18"><a href="#Unbiased-Space-Saving-SIGMOD’18" class="headerlink" title="Unbiased Space Saving (SIGMOD’18)"></a>Unbiased Space Saving (SIGMOD’18)</h4><p><img src="/image-20230423125709819.png" class="lazyload placeholder" data-srcset="/image-20230423125709819.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<blockquote>
<p>论文：<em>Daniel Ting. Data sketches for disaggregated subset sum and frequent item estimation. In SIGMOD Conference, 2018.</em></p>
</blockquote>
<h4 id="Waving-Sketch-SIGKDD’20"><a href="#Waving-Sketch-SIGKDD’20" class="headerlink" title="Waving Sketch (SIGKDD’20)"></a>Waving Sketch (SIGKDD’20)</h4><p><img src="/image-20230423133930590.png" class="lazyload placeholder" data-srcset="/image-20230423133930590.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423131126551.png" class="lazyload placeholder" data-srcset="/image-20230423131126551.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/WavingSketch/Waving-Sketch">WavingSketch/Waving-Sketch: WavingSketch: An Unbiased and Generic Sketch for Finding Top-k Items in Data Streams (github.com)</a></p>
<blockquote>
<p>论文：<em>Jizhou Li, Zikun Li, Yifei Xu, Shiqi Jiang, Tong Yang, Bin Cui, Yafei Dai and Gong Zhang. WavingSketch: An Unbiased and Generic Sketch for Finding Top-k Items in Data Streams. ACM SIGKDD 2020</em></p>
</blockquote>
<h4 id="Sliding-Sketch-SIGKDD’20"><a href="#Sliding-Sketch-SIGKDD’20" class="headerlink" title="Sliding Sketch (SIGKDD’20)"></a>Sliding Sketch (SIGKDD’20)</h4><p><strong>对滑动窗口数据流做测量的一个框架，滑动窗口基于数量或时间</strong></p>
<h5 id="PRIOR-ART"><a href="#PRIOR-ART" class="headerlink" title="PRIOR ART"></a>PRIOR ART</h5><p><img src="/image-20230423132744951.png" class="lazyload placeholder" data-srcset="/image-20230423132744951.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="K-HASH-MODEL"><a href="#K-HASH-MODEL" class="headerlink" title="K-HASH MODEL"></a>K-HASH MODEL</h5><p><img src="/image-20230423132928769.png" class="lazyload placeholder" data-srcset="/image-20230423132928769.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423133040461.png" class="lazyload placeholder" data-srcset="/image-20230423133040461.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="SLIDING-SKETCH"><a href="#SLIDING-SKETCH" class="headerlink" title="SLIDING SKETCH"></a>SLIDING SKETCH</h5><p><img src="/image-20230423133326452.png" class="lazyload placeholder" data-srcset="/image-20230423133326452.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423134118866.png" class="lazyload placeholder" data-srcset="/image-20230423134118866.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Jet-lag"><a href="#Jet-lag" class="headerlink" title="Jet lag"></a>Jet lag</h5><p><img src="/image-20230423134757213.png" class="lazyload placeholder" data-srcset="/image-20230423134757213.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423135107822.png" class="lazyload placeholder" data-srcset="/image-20230423135107822.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423135449208.png" class="lazyload placeholder" data-srcset="/image-20230423135449208.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/sliding-sketch/Sliding-Sketch">sliding-sketch/Sliding-Sketch (github.com)</a></p>
<blockquote>
<p>论文：<em>Xiangyang Gou, Long He, Yinda Zhang, Ke Wang, Xilai Liu, Tong Yang, Yi Wang and Bin Cui. Sliding Sketches: A Framework using Time Zones for Data Stream Processing in Sliding Windows. ACM SIGKDD 2020</em></p>
</blockquote>
<h4 id="SketchML-SIGMOD’18"><a href="#SketchML-SIGMOD’18" class="headerlink" title="SketchML (SIGMOD’18)"></a>SketchML (SIGMOD’18)</h4><h5 id="Background-and-Motivation-Gradient-Compression"><a href="#Background-and-Motivation-Gradient-Compression" class="headerlink" title="Background and Motivation-Gradient Compression"></a>Background and Motivation-Gradient Compression</h5><p><img src="/image-20230423151853043.png" class="lazyload placeholder" data-srcset="/image-20230423151853043.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423152039863.png" class="lazyload placeholder" data-srcset="/image-20230423152039863.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="PRIOR-ART：相当于使用一种截断的方式去压缩梯度的值，将浮点数映射到一个d-bit整数空间"><a href="#PRIOR-ART：相当于使用一种截断的方式去压缩梯度的值，将浮点数映射到一个d-bit整数空间" class="headerlink" title="PRIOR ART：相当于使用一种截断的方式去压缩梯度的值，将浮点数映射到一个d-bit整数空间"></a>PRIOR ART：相当于使用一种截断的方式去压缩梯度的值，将浮点数映射到一个d-bit整数空间</h6><p><img src="/image-20230423152344327.png" class="lazyload placeholder" data-srcset="/image-20230423152344327.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="challenge"><a href="#challenge" class="headerlink" title="challenge"></a>challenge</h6><p><img src="/image-20230423153242938.png" class="lazyload placeholder" data-srcset="/image-20230423153242938.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Idea"><a href="#Idea" class="headerlink" title="Idea"></a>Idea</h5><h6 id="quantile-sketch"><a href="#quantile-sketch" class="headerlink" title="quantile sketch"></a>quantile sketch</h6><p><img src="/image-20230423155526565.png" class="lazyload placeholder" data-srcset="/image-20230423155526565.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423155959249.png" class="lazyload placeholder" data-srcset="/image-20230423155959249.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="MinMax-sketch"><a href="#MinMax-sketch" class="headerlink" title="MinMax sketch"></a>MinMax sketch</h6><p>设计一个低估的sketch：过高估计的误差放大了梯度值，这可能导致发散；误差的低估减小了梯度值的尺度，但对校正收敛没有危害</p>
<p><img src="/image-20230423160357331.png" class="lazyload placeholder" data-srcset="/image-20230423160357331.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423160906619.png" class="lazyload placeholder" data-srcset="/image-20230423160906619.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h6 id="Delta-Binary-Encoding"><a href="#Delta-Binary-Encoding" class="headerlink" title="Delta-Binary Encoding"></a>Delta-Binary Encoding</h6><p>压缩keys的方法</p>
<p><img src="/image-20230423163346798.png" class="lazyload placeholder" data-srcset="/image-20230423163346798.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="overview"><a href="#overview" class="headerlink" title="overview"></a>overview</h5><p><img src="/image-20230423163520419.png" class="lazyload placeholder" data-srcset="/image-20230423163520419.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="conclusion-1"><a href="#conclusion-1" class="headerlink" title="conclusion"></a>conclusion</h5><p><img src="/image-20230423163930180.png" class="lazyload placeholder" data-srcset="/image-20230423163930180.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>论文笔记：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36645271/article/details/91044383">(95条消息) 【论文阅读】SketchML: Accelerating Distributed Machine Learning with Data Sketches_sketch稀疏梯度_Jermiane的博客-CSDN博客</a></p>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/axenov/SketchML">axenov/SketchML: SketchML - distributed Machine Leaning framework for Apache Flink (github.com)</a></p>
<blockquote>
<p>论文：<em>Jiawei Jiang, Fangcheng Fu, Tong Yang, Bin Cui. SketchML: Accelerating Distributed Machine Learning with Data Sketches. SIGMOD 2018</em></p>
</blockquote>
<h4 id="MLSketch-SIGCOMM’18-workshop"><a href="#MLSketch-SIGCOMM’18-workshop" class="headerlink" title="MLSketch (SIGCOMM’18 workshop)"></a>MLSketch (SIGCOMM’18 workshop)</h4><h5 id="Background-2"><a href="#Background-2" class="headerlink" title="Background"></a>Background</h5><p>The reason behind this is that the algorithms that insert approximate information about the desired metric into the sketches and then estimate that metric when required, are based on hand-derived theoretical models. In order to hand-derive such models, it is imperative to make simplifying assumptions about the network traffic because hand-deriving a model that covers all practical scenarios is just not possible. As the characteristics of network traffic vary a lot in practice and <strong>the simplifying assumptions do not always hold</strong>, the accuracies of existing sketches vary a lot when used in real-world deployments.</p>
<p><img src="/image-20230423172326787.png" class="lazyload placeholder" data-srcset="/image-20230423172326787.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Machine-Learning-Framework"><a href="#Machine-Learning-Framework" class="headerlink" title="Machine Learning Framework"></a>Machine Learning Framework</h5><p>This Figure shows our framework. Our framework has two parts: sampling and machine learning.</p>
<p>As the traffic rate is often very high, it is difficult to learn all traffic. Instead, we use only a small percentage of all packets to generate the models for machine learning. To achieve fast sampling, we just record the header of one packet after every  λ packets, but do not care about the flow ID during the sampling. In our framework, the network manager can specify the sampling rate based on the available resources.</p>
<p>We build a learning sketch for the sampled set, and then choose appropriate features to obtain the training set. On the other hand, we build a regular sketch, such as CM, CU, or Count for all packets. The training results are used for improve the querying process.</p>
<p>After generating the learning sketch, in our framework, we extract appropriate features from the learning sketch to build the adaptive theoretical model. The features that we extract depend on the flow-level metric being measured, and naturally are different for different metrics. The ground truth for training comes from the set S. </p>
<p>The block “Feature Extraction, Training set generation” in this figure represents the process of extracting these features and generating a set of training samples. </p>
<p><img src="/image-20230423172712059.png" class="lazyload placeholder" data-srcset="/image-20230423172712059.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Implementations-1"><a href="#Implementations-1" class="headerlink" title="Implementations"></a>Implementations</h5><p>As shown this figure, there are two parts in our architecture: a switch and a server.</p>
<ol>
<li><p>switch<br>The switch is responsible for generating the regular sketches, such as CM, CU, CSM, and FM sketches.<br>The switch is also responsible for sampling packets.</p>
</li>
<li><p>server<br>The server has two network interface cards: one supports DPDK(<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Data_Plane_Development_Kit">Data Plane Development Kit</a>) and receives the sampled set from the switch, and the other is used to receive queries and return results.</p>
</li>
<li><p>queue<br>There are three queues in total.<br>This queue is a hardware (HW) ring, it is used for receiving packets from the interface card. These two rings are software (SW) rings, and is used as a pipe to transfer data. These rings are defined and managed by DPDK. We only store pointers to the data in the memory pool.</p>
</li>
</ol>
<p><img src="/image-20230423173436643.png" class="lazyload placeholder" data-srcset="/image-20230423173436643.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="Case-Studies"><a href="#Case-Studies" class="headerlink" title="Case Studies"></a>Case Studies</h5><h6 id="Flow-Size-Estimation"><a href="#Flow-Size-Estimation" class="headerlink" title="Flow Size Estimation"></a>Flow Size Estimation</h6><p>There are two kinds of flows. The first kind has very small error, and we do nothing, because machine learning cannot help. The second kind has large error, and in this case, machine learning can help. We have such an observation: For each flow ID, we compute hash functions, and get the d counters. We observe these counters and find that when <strong>the two smallest counters are very different</strong>, the flow probably has large error.</p>
<p><img src="/image-20230423174425276.png" class="lazyload placeholder" data-srcset="/image-20230423174425276.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423174524161.png" class="lazyload placeholder" data-srcset="/image-20230423174524161.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423175010619.png" class="lazyload placeholder" data-srcset="/image-20230423175010619.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>Query: First Check whether is it a error prone flow?</p>
<ol>
<li>No, original method, e.g.,  report the smallest one.</li>
<li>Yes, use the  Hypothesis function to minimize noise</li>
</ol>
<h6 id="Heavy-Hitter-Detection"><a href="#Heavy-Hitter-Detection" class="headerlink" title="Heavy Hitter Detection"></a>Heavy Hitter Detection</h6><p><strong>top-k问题</strong></p>
<p><img src="/image-20230423175345171.png" class="lazyload placeholder" data-srcset="/image-20230423175345171.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><strong>两种错误</strong></p>
<p><img src="/image-20230423175605067.png" class="lazyload placeholder" data-srcset="/image-20230423175605067.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423175717094.png" class="lazyload placeholder" data-srcset="/image-20230423175717094.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><strong>Classification task</strong></p>
<p><img src="/image-20230423175854420.png" class="lazyload placeholder" data-srcset="/image-20230423175854420.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423175956547.png" class="lazyload placeholder" data-srcset="/image-20230423175956547.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><strong>Estimation task</strong></p>
<p><img src="/image-20230423180207132.png" class="lazyload placeholder" data-srcset="/image-20230423180207132.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p>Queries have two steps:</p>
<ol>
<li>Eliminate suspicious flows</li>
<li>Estimate the size of the remaining flows using linear regression model</li>
</ol>
<h6 id="Cardinality-flows"><a href="#Cardinality-flows" class="headerlink" title="Cardinality: # flows"></a>Cardinality: # flows</h6><p><img src="/image-20230423213557985.png" class="lazyload placeholder" data-srcset="/image-20230423213557985.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<p><img src="/image-20230423213618228.png" class="lazyload placeholder" data-srcset="/image-20230423213618228.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"></p>
<h5 id="conclusion-2"><a href="#conclusion-2" class="headerlink" title="conclusion"></a>conclusion</h5><ol>
<li>We propose the idea of applying ML to sketches for the first time, and propose a generic framework.</li>
<li>We present three case studies: flow sizes, top-k flows, and cardinality.</li>
<li>We implement our framework and perform many experiments using real traffic.</li>
</ol>
<p>开源代码：<a target="_blank" rel="noopener" href="https://github.com/wanglun1996/ML-Sketch">wanglun1996/ML-Sketch (github.com)</a></p>
<blockquote>
<p>论文：<em>Tong Yang, Lun Wang, Yulong Shen, Muhammad Shahzad, Qun Huang, Xiaohong Jiang, Kun Tan, Xiaoming Li. Empowering Sketches with Machine Learning for Network Measurements. SIGCOMM workshop on NetAI 2018.</em></p>
</blockquote>
<h4 id="Other-directions"><a href="#Other-directions" class="headerlink" title="Other directions"></a>Other directions</h4><ul>
<li>Time sensitive Query</li>
<li>Graph Streams</li>
<li>Sketch for classification</li>
<li>Persistent</li>
</ul>

      </div>
      <div class="post-tags-categories">
        
        <div class="tags">
          
            <a href="/tags/sketch/" class="">
              sketch
            </a>
          
            <a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%8B%E9%87%8F/" class="">
              网络测量
            </a>
          
        </div>
        
      </div>
      
        <div class="copyright">
  <ul class="post-copyright">
    <li class="post-copyright-author">
    <strong>作者:  </strong>Jan</a>
    </li>
    <li class="post-copyright-link">
    <strong>文章链接:  </strong>
    <a href="/2023/04/15/sketch-diao-yan/" target="_blank" title="sketch调研">https://Jan-nku.github.io/2023/04/15/sketch-diao-yan/</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明:   </strong>
      本网站所有文章除特别声明外,均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
      许可协议。转载请注明出处!
    </li>
  </ul>
<div>
      
    </article>
    <!-- 上一篇文章和下一篇文章 -->
    
      <!-- 文章详情页的上一页和下一页 -->
<div class="post-nav">





  
  <div class="post-nav-next post-nav-item">
    <div class="post-nav-img" style="background-size: cover; 
      background-position: center center;">
      <img class="lazyload lazyload placeholder" src="https://pic3.zhimg.com/80/v2-5f7cb7e900b9dcf5354c3d4d2c5cc3c2_1440w.webp" class="lazyload placeholder" data-srcset="https://pic3.zhimg.com/80/v2-5f7cb7e900b9dcf5354c3d4d2c5cc3c2_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" src="" alt="">
    </div>
    <a href="/2023/03/31/ch6-shi-zhan-wang-luo-ceng-zi-ding-yi-tuo-bu-jie-gou/" class="post-nav-link">
      <div class="title">
        下一篇: <i class="fas fa-angle-right"></i>
        <div class="title-text">ch6实战网络层，自定义拓扑结构</div>
      </div>
      <!-- <div class="content">
        自定义网络拓扑结构123456789101112131415161718192021222324252627282930
      </div> -->
    </a>
  </div>

</div>

    
    

    <!-- 打赏 -->
    

    <!-- 分享 -->
    
      <!-- https://github.com/overtrue/share.js -->
<!-- 文章详情页的分享 -->
<div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>

<script src="/js/shareJs/social-share.min.js"></script>
</script>

<style>
  .social-share {
    margin: 20px 0;
  }
</style>


    
    
    <!-- 评论 -->
    <!-- 评论 -->

  <div id="myComment">
    
      <div id="gitment-ctn"></div> 

<!-- 修改css与js文件如下即可-->
<!-- <link rel="stylesheet" href="https://billts.site/extra_css/gitment.css">
<script src="https://billts.site/js/gitment.js"></script> -->
<link rel='stylesheet' href='https://unpkg.com/gitment@0.0.3/style/default.css'>


<style>
  .gitment-comment-header {
    margin: 0;
    padding: 5px;
  }
</style>

    
  </div>

<!-- comment script in themes\hexo-theme-bamboo\layout\_partial\scripts\index.ejs -->


  </div>

  <!-- 目录 -->
  
<aside id='l_side'>
  
    
      
        <section class="widget side_blogger">
  <div class='content'>
    
    
      <div class='text'>
        
          <h2>NKU-Jan</h2>
        
        
          <p>CS Blog</p>

        
        
          <p><span id="jinrishici-sentence">Jan's Blog</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="/jan_nku@163.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="https://github.com/Jan-nku/Jan-nku.github.io"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=2643292013"
              class="social fab fa-qq flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
      </div>
    
  </div>
</section>

      
    
  
  
  
    
  

  <div class="layout_sticky">    
    
      
<section class="widget side_toc">
  
  <header>
    
      <i style="color: " class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


  <div class='content'>
    <div class="toc-main">
      <div class="toc-content">
        <!-- <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Sketch%E8%B0%83%E7%A0%94"><span class="toc-text">Sketch调研</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Measurement-Tasks"><span class="toc-text">Measurement Tasks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Data-Stream-Network-Traffic"><span class="toc-text">Data Stream&#x2F;Network Traffic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Measurement-Tasks-1"><span class="toc-text">Measurement Tasks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sketch-Algorithms"><span class="toc-text">Sketch Algorithms</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sketch"><span class="toc-text">sketch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E6%97%A9%E7%9A%84Sketch"><span class="toc-text">比较早的Sketch</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Count-Min-Sketch"><span class="toc-text">Count-Min Sketch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CU-Sketch"><span class="toc-text">CU Sketch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Count-Sketch-unbiased"><span class="toc-text">Count Sketch (unbiased)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CMM-Sketch-unbiased"><span class="toc-text">CMM Sketch  (unbiased)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Randomized-CM-Sketch"><span class="toc-text">Randomized CM Sketch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Augmented-sketch-Sigmod%E2%80%9916"><span class="toc-text">Augmented sketch(Sigmod’16)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FM-Sketch"><span class="toc-text">FM Sketch</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E4%B8%80%E4%BA%9B%E7%9A%84Sketch"><span class="toc-text">复杂一些的Sketch</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Pyramid-Sketch-VLDB%E2%80%9917"><span class="toc-text">Pyramid Sketch (VLDB’17)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SpaceSaving"><span class="toc-text">SpaceSaving</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LTC-ICDE%E2%80%9919-Significant-Items"><span class="toc-text">LTC (ICDE’19) Significant Items</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Background"><span class="toc-text">Background</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#related-work"><span class="toc-text">related work</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Long-tail-Clock-LTC"><span class="toc-text">Long-tail Clock (LTC)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#LTC%E2%80%94Data-structure"><span class="toc-text">LTC—Data structure</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#LTC%E2%80%94Insertion-update-frequency"><span class="toc-text">LTC—Insertion (update frequency)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#LTC%E2%80%94Insertion-update-persistency"><span class="toc-text">LTC—Insertion (update persistency)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#LTC%E2%80%94Query"><span class="toc-text">LTC—Query</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Optimizations"><span class="toc-text">Optimizations</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Optimizations%E2%80%94Long-tail-Replacement"><span class="toc-text">Optimizations—Long-tail Replacement</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Optimizations%E2%80%94Deviation-Eliminator"><span class="toc-text">Optimizations—Deviation Eliminator</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Experiments"><span class="toc-text">Experiments</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HeavyGuardian-SIGKDD%E2%80%9918"><span class="toc-text">HeavyGuardian (SIGKDD’18)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Elastic-Sketch-SIGCOMM%E2%80%9918"><span class="toc-text">Elastic Sketch (SIGCOMM’18)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Background-1"><span class="toc-text">Background</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Elastic-Sketches"><span class="toc-text">Elastic Sketches</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Rationale"><span class="toc-text">Rationale</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Adaptivity"><span class="toc-text">Adaptivity</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Optimizations-1"><span class="toc-text">Optimizations</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Software-Version"><span class="toc-text">Software Version</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Hardware-Version"><span class="toc-text">Hardware Version</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#P4Switch-Version"><span class="toc-text">P4Switch Version</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Multi-Core-Version"><span class="toc-text">Multi-Core Version</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Applications"><span class="toc-text">Applications</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Implementations"><span class="toc-text">Implementations</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Experimental-Results-Summary"><span class="toc-text">Experimental Results Summary</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#conclusion"><span class="toc-text">conclusion</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cold-Filter-SIGMOD-18"><span class="toc-text">Cold Filter (SIGMOD 18)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Recent-Directions"><span class="toc-text">Recent Directions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Unbiased-Space-Saving-SIGMOD%E2%80%9918"><span class="toc-text">Unbiased Space Saving (SIGMOD’18)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Waving-Sketch-SIGKDD%E2%80%9920"><span class="toc-text">Waving Sketch (SIGKDD’20)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sliding-Sketch-SIGKDD%E2%80%9920"><span class="toc-text">Sliding Sketch (SIGKDD’20)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIOR-ART"><span class="toc-text">PRIOR ART</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#K-HASH-MODEL"><span class="toc-text">K-HASH MODEL</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SLIDING-SKETCH"><span class="toc-text">SLIDING SKETCH</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Jet-lag"><span class="toc-text">Jet lag</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SketchML-SIGMOD%E2%80%9918"><span class="toc-text">SketchML (SIGMOD’18)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Background-and-Motivation-Gradient-Compression"><span class="toc-text">Background and Motivation-Gradient Compression</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#PRIOR-ART%EF%BC%9A%E7%9B%B8%E5%BD%93%E4%BA%8E%E4%BD%BF%E7%94%A8%E4%B8%80%E7%A7%8D%E6%88%AA%E6%96%AD%E7%9A%84%E6%96%B9%E5%BC%8F%E5%8E%BB%E5%8E%8B%E7%BC%A9%E6%A2%AF%E5%BA%A6%E7%9A%84%E5%80%BC%EF%BC%8C%E5%B0%86%E6%B5%AE%E7%82%B9%E6%95%B0%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AAd-bit%E6%95%B4%E6%95%B0%E7%A9%BA%E9%97%B4"><span class="toc-text">PRIOR ART：相当于使用一种截断的方式去压缩梯度的值，将浮点数映射到一个d-bit整数空间</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#challenge"><span class="toc-text">challenge</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Idea"><span class="toc-text">Idea</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#quantile-sketch"><span class="toc-text">quantile sketch</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#MinMax-sketch"><span class="toc-text">MinMax sketch</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Delta-Binary-Encoding"><span class="toc-text">Delta-Binary Encoding</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#overview"><span class="toc-text">overview</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#conclusion-1"><span class="toc-text">conclusion</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MLSketch-SIGCOMM%E2%80%9918-workshop"><span class="toc-text">MLSketch (SIGCOMM’18 workshop)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Background-2"><span class="toc-text">Background</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Machine-Learning-Framework"><span class="toc-text">Machine Learning Framework</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Implementations-1"><span class="toc-text">Implementations</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Case-Studies"><span class="toc-text">Case Studies</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Flow-Size-Estimation"><span class="toc-text">Flow Size Estimation</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Heavy-Hitter-Detection"><span class="toc-text">Heavy Hitter Detection</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Cardinality-flows"><span class="toc-text">Cardinality: # flows</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#conclusion-2"><span class="toc-text">conclusion</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Other-directions"><span class="toc-text">Other directions</span></a></li></ol></li></ol></li></ol></li></ol> -->
        <div class="toc"></div>
      </div>
    </div>
  </div>
</section>
<!-- 手机端目录按钮 -->
<div id="toc-mobile-btn">
  <i class="fas fa-list-ul" aria-hidden="true"></i>
</div>

      
  <section class="widget side_recent_post">
    
  <header>
    
      <a style="color: " href='/tags/'><i class="fas fa-book fa-fw" aria-hidden="true"></i><span class='name'>最新文章</span></a>
    
  </header>


    <div class='content'>
      
      <!-- hash算法 -->
      
      <div class="aside-list">
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/04/15/sketch-diao-yan/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://picx.zhimg.com/80/v2-b44931ea513e5f7b3b06f2703f79653c_1440w.webp" class="lazyload placeholder" data-srcset="https://picx.zhimg.com/80/v2-b44931ea513e5f7b3b06f2703f79653c_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">04-15</span>
                
              </div>
              <a class="post-title" href="/2023/04/15/sketch-diao-yan/">sketch调研</a>
            </div>
          </div>
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/03/31/ch6-shi-zhan-wang-luo-ceng-zi-ding-yi-tuo-bu-jie-gou/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://pic3.zhimg.com/80/v2-5f7cb7e900b9dcf5354c3d4d2c5cc3c2_1440w.webp" class="lazyload placeholder" data-srcset="https://pic3.zhimg.com/80/v2-5f7cb7e900b9dcf5354c3d4d2c5cc3c2_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">03-31</span>
                
              </div>
              <a class="post-title" href="/2023/03/31/ch6-shi-zhan-wang-luo-ceng-zi-ding-yi-tuo-bu-jie-gou/">ch6实战网络层，自定义拓扑结构</a>
            </div>
          </div>
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/03/30/ch5-shi-zhan-lian-lu-ceng/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://pic3.zhimg.com/80/v2-5f7cb7e900b9dcf5354c3d4d2c5cc3c2_1440w.webp" class="lazyload placeholder" data-srcset="https://pic3.zhimg.com/80/v2-5f7cb7e900b9dcf5354c3d4d2c5cc3c2_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">03-30</span>
                
              </div>
              <a class="post-title" href="/2023/03/30/ch5-shi-zhan-lian-lu-ceng/">ch5实战链路层</a>
            </div>
          </div>
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/03/30/ch4-shi-zhan-reflector-repeater/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://picx.zhimg.com/80/v2-b44931ea513e5f7b3b06f2703f79653c_1440w.webp" class="lazyload placeholder" data-srcset="https://picx.zhimg.com/80/v2-b44931ea513e5f7b3b06f2703f79653c_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">03-30</span>
                
              </div>
              <a class="post-title" href="/2023/03/30/ch4-shi-zhan-reflector-repeater/">ch4实战 Reflector &amp; Repeater</a>
            </div>
          </div>
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/03/29/ch3-kong-zhi-luo-ji-yu-wan-zheng-de-gong-zuo-liu/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://picx.zhimg.com/80/v2-85c31120acff76826ab53ea8934ef4bb_1440w.webp" class="lazyload placeholder" data-srcset="https://picx.zhimg.com/80/v2-85c31120acff76826ab53ea8934ef4bb_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">03-29</span>
                
              </div>
              <a class="post-title" href="/2023/03/29/ch3-kong-zhi-luo-ji-yu-wan-zheng-de-gong-zuo-liu/">ch3控制逻辑与完整的工作流</a>
            </div>
          </div>
        
      </div>
    </div>
  </section>

    
  </div>
</aside>


  <!-- 图片放大 Wrap images with fancybox support -->
  <script src="/js/wrapImage.js"></script>
</div>

<!-- 文章详情页背景图 -->
<div id="appBgSwiper" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;"
	:style="{'background-color': bgColor ? bgColor : 'transparent'}">
	<transition-group tag="ul" :name="names">
		<li v-for='(image,index) in img' :key='index' v-show="index === mark" class="bg-swiper-box">
			<img :src="image" class="bg-swiper-img no-lazy">
		</li>
	</transition-group>
</div>
<script>
	var vm = new Vue({
		el: '#appBgSwiper',
		data: {
			names: '' || 'fade' || 'fade', // translate-fade fade
			mark: 0,
			img: [],
			bgColor: '',
			time: null
		},
		methods: {   //添加方法
			change(i, m) {
				if (i > m) {
					// this.names = 'fade';
				} else if (i < m) {
					// this.names = 'fade';
				} else {
					return;
				}
				this.mark = i;
			},
			prev() {
				// this.names = 'fade';
				this.mark--;
				if (this.mark === -1) {
					this.mark = 3;
					return
				}
			},
			next() {
				// this.names = 'fade';
				this.mark++;
				if (this.mark === this.img.length) {
					this.mark = 0;
					return
				}
			},
			autoPlay() {
				// this.names = 'fade';
				this.mark++;
				if (this.mark === this.img.length) {
					this.mark = 0;
					return
				}
			},
			play() {
				let bgImgDelay = '' || '180000'
				let delay = parseInt(bgImgDelay) || 180000;
				this.time = setInterval(this.autoPlay, delay);
			},
			enter() {
				clearInterval(this.time);
			},
			leave() {
				this.play();
			}
		},
		created() {
			this.play()
		},
		beforeDestroy() {
			clearInterval(this.time);
		},
		mounted() {
			let prop = '' || '';
			let isImg = prop.includes('.bmp') || prop.includes('.jpg') || prop.includes('.png') || prop.includes('.tif') || prop.includes('.gif') || prop.includes('.pcx') || prop.includes('.tga') || prop.includes('.exif') || prop.includes('.fpx') || prop.includes('.psd') || prop.includes('.cdr') || prop.includes('.pcd') || prop.includes('.dxf') || prop.includes('.ufo') || prop.includes('.eps') || prop.includes('.ai') || prop.includes('.raw') || prop.includes('.WMF') || prop.includes('.webp') || prop.includes('.jpeg') || prop.includes('http://') || prop.includes('https://')
			if (isImg) {
				let img = prop.split(',');
				let configRoot = '/'
				let arrImg = [];
				img.forEach(el => {
					var Expression = /http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;
					var objExp = new RegExp(Expression);

					if (objExp.test(el)) {
						// http or https
						arrImg.push(el);
					} else {
						// 非http or https开头
						// 本地文件
						let firstStr = el.charAt(0);
						if (firstStr == '/') {
							el = el.substr(1); // 删除第一个字符 '/',因为 configRoot最后一个字符为 /
						}
						el = configRoot + el;
						arrImg.push(el);
					}
				})
				this.img = arrImg;
			} else {
				this.bgColor = prop;
			}
		}
	})
</script>

<style>
	.bg-swiper-box {
		position: absolute;
		display: block;
		width: 100%;
		height: 100%;
	}

	.bg-swiper-img {
		object-fit: cover;
		width: 100%;
		height: 100%;
	}
</style>




  <script>
  function loadMermaid() {
    if (document.getElementsByClassName('mermaid').length) {
      if (window.mermaidJsLoad) mermaid.init()
      else {
        loadScript('https://unpkg.com/mermaid/dist/mermaid.min.js').then(() => {
          window.mermaidJsLoad = true
          mermaid.initialize({
            theme: 'default',
          })
          if ('true') {
            mermaid.init();
          }
        })
      }
    }
  };
  document.addEventListener("DOMContentLoaded", function () {
    loadMermaid();
  })

  document.addEventListener('pjax:complete', function () {
    loadMermaid();
  })
  
</script>


      </main>
    </div>

    <!-- 页脚 -->
    
  
  
    <!-- 底部鱼儿跳动效果，依赖于jquery-->
<div id="j-fish-skip" style=" position: relative;height: 153px;width: auto;"></div>
<script>
  var RENDERER = {
    POINT_INTERVAL: 5,
    FISH_COUNT: 3,
    MAX_INTERVAL_COUNT: 50,
    INIT_HEIGHT_RATE: .5,
    THRESHOLD: 50,
    FISH_COLOR: '',
    init: function () {
      this.setFishColor(); this.setParameters(), this.reconstructMethods(), this.setup(), this.bindEvent(), this.render()
    },
    setFishColor: function () {
      let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');
      if (isDark) {
        this.FISH_COLOR = '#222'; // 暗黑色，有时间把这整成一个变量
      } else {
        this.FISH_COLOR = '' || 'rgba(66, 185, 133, 0.8)';
      }
    },
    setParameters: function () {
      this.$window = $(window), this.$container = $("#j-fish-skip"), this.$canvas = $("<canvas />"), this.context = this.$canvas.appendTo(this.$container).get(0).getContext("2d"), this.points = [], this.fishes = [], this.watchIds = []
    },
    createSurfacePoints: function () {
      var t = Math.round(this.width / this.POINT_INTERVAL);
      this.pointInterval = this.width / (t - 1), this.points.push(new SURFACE_POINT(this, 0));
      for (var i = 1; i < t; i++) {
        var e = new SURFACE_POINT(this, i * this.pointInterval),
          h = this.points[i - 1];
        e.setPreviousPoint(h), h.setNextPoint(e), this.points.push(e)
      }
    },
    reconstructMethods: function () {
      this.watchWindowSize = this.watchWindowSize.bind(this), this.jdugeToStopResize = this.jdugeToStopResize.bind(this), this.startEpicenter = this.startEpicenter.bind(this), this.moveEpicenter = this.moveEpicenter.bind(this), this.reverseVertical = this.reverseVertical.bind(this), this.render = this.render.bind(this)
    },
    setup: function () {
      this.points.length = 0, this.fishes.length = 0, this.watchIds.length = 0, this.intervalCount = this.MAX_INTERVAL_COUNT, this.width = this.$container.width(), this.height = this.$container.height(), this.fishCount = this.FISH_COUNT * this.width / 500 * this.height / 500, this.$canvas.attr({
        width: this.width,
        height: this.height
      }), this.reverse = !1, this.fishes.push(new FISH(this)), this.createSurfacePoints()
    },
    watchWindowSize: function () {
      this.clearTimer(), this.tmpWidth = this.$window.width(), this.tmpHeight = this.$window.height(), this.watchIds.push(setTimeout(this.jdugeToStopResize, this.WATCH_INTERVAL))
    },
    clearTimer: function () {
      for (; this.watchIds.length > 0;) clearTimeout(this.watchIds.pop())
    },
    jdugeToStopResize: function () {
      var t = this.$window.width(),
        i = this.$window.height(),
        e = t == this.tmpWidth && i == this.tmpHeight;
      this.tmpWidth = t, this.tmpHeight = i, e && this.setup()
    },
    bindEvent: function () {
      this.$window.on("resize", this.watchWindowSize), this.$container.on("mouseenter", this.startEpicenter), this.$container.on("mousemove", this.moveEpicenter)
    },
    getAxis: function (t) {
      var i = this.$container.offset();
      return {
        x: t.clientX - i.left + this.$window.scrollLeft(),
        y: t.clientY - i.top + this.$window.scrollTop()
      }
    },
    startEpicenter: function (t) {
      this.axis = this.getAxis(t)
    },
    moveEpicenter: function (t) {
      var i = this.getAxis(t);
      this.axis || (this.axis = i), this.generateEpicenter(i.x, i.y, i.y - this.axis.y), this.axis = i
    },
    generateEpicenter: function (t, i, e) {
      if (!(i < this.height / 2 - this.THRESHOLD || i > this.height / 2 + this.THRESHOLD)) {
        var h = Math.round(t / this.pointInterval);
        h < 0 || h >= this.points.length || this.points[h].interfere(i, e)
      }
    },
    reverseVertical: function () {
      this.reverse = !this.reverse;
      for (var t = 0, i = this.fishes.length; t < i; t++) this.fishes[t].reverseVertical()
    },
    controlStatus: function () {
      for (var t = 0, i = this.points.length; t < i; t++) this.points[t].updateSelf();
      for (t = 0, i = this.points.length; t < i; t++) this.points[t].updateNeighbors();
      this.fishes.length < this.fishCount && 0 == --this.intervalCount && (this.intervalCount = this.MAX_INTERVAL_COUNT, this.fishes.push(new FISH(this)))
    },
    render: function () {
      requestAnimationFrame(this.render), this.controlStatus(), this.context.clearRect(0, 0, this.width, this.height), this.context.fillStyle = this.FISH_COLOR;
      for (var t = 0, i = this.fishes.length; t < i; t++) this.fishes[t].render(this.context);
      this.context.save(), this.context.globalCompositeOperation = "xor", this.context.beginPath(), this.context.moveTo(0, this.reverse ? 0 : this.height);
      for (t = 0, i = this.points.length; t < i; t++) this.points[t].render(this.context);
      this.context.lineTo(this.width, this.reverse ? 0 : this.height), this.context.closePath(), this.context.fill(), this.context.restore()
    }
  },
  SURFACE_POINT = function (t, i) {
    this.renderer = t, this.x = i, this.init()
  };
  SURFACE_POINT.prototype = {
    SPRING_CONSTANT: .03,
    SPRING_FRICTION: .9,
    WAVE_SPREAD: .3,
    ACCELARATION_RATE: .01,
    init: function () {
      this.initHeight = this.renderer.height * this.renderer.INIT_HEIGHT_RATE, this.height = this.initHeight, this.fy = 0, this.force = {
        previous: 0,
        next: 0
      }
    },
    setPreviousPoint: function (t) {
      this.previous = t
    },
    setNextPoint: function (t) {
      this.next = t
    },
    interfere: function (t, i) {
      this.fy = this.renderer.height * this.ACCELARATION_RATE * (this.renderer.height - this.height - t >= 0 ? -1 : 1) * Math.abs(i)
    },
    updateSelf: function () {
      this.fy += this.SPRING_CONSTANT * (this.initHeight - this.height), this.fy *= this.SPRING_FRICTION, this.height += this.fy
    },
    updateNeighbors: function () {
      this.previous && (this.force.previous = this.WAVE_SPREAD * (this.height - this.previous.height)), this.next && (this.force.next = this.WAVE_SPREAD * (this.height - this.next.height))
    },
    render: function (t) {
      this.previous && (this.previous.height += this.force.previous, this.previous.fy += this.force.previous), this.next && (this.next.height += this.force.next, this.next.fy += this.force.next), t.lineTo(this.x, this.renderer.height - this.height)
    }
  };
  var FISH = function (t) {
    this.renderer = t, this.init()
  };
  FISH.prototype = {
    GRAVITY: .4,
    init: function () {
      this.direction = Math.random() < .5, this.x = this.direction ? this.renderer.width + this.renderer.THRESHOLD : -this.renderer.THRESHOLD, this.previousY = this.y, this.vx = this.getRandomValue(4, 10) * (this.direction ? -1 : 1), this.renderer.reverse ? (this.y = this.getRandomValue(1 * this.renderer.height / 10, 4 * this.renderer.height / 10), this.vy = this.getRandomValue(2, 5), this.ay = this.getRandomValue(.05, .2)) : (this.y = this.getRandomValue(6 * this.renderer.height / 10, 9 * this.renderer.height / 10), this.vy = this.getRandomValue(-5, -2), this.ay = this.getRandomValue(-.2, -.05)), this.isOut = !1, this.theta = 0, this.phi = 0
    },
    getRandomValue: function (t, i) {
      return t + (i - t) * Math.random()
    },
    reverseVertical: function () {
      this.isOut = !this.isOut, this.ay *= -1
    },
    controlStatus: function (t) {
      this.previousY = this.y, this.x += this.vx, this.y += this.vy, this.vy += this.ay, this.renderer.reverse ? this.y > this.renderer.height * this.renderer.INIT_HEIGHT_RATE ? (this.vy -= this.GRAVITY, this.isOut = !0) : (this.isOut && (this.ay = this.getRandomValue(.05, .2)), this.isOut = !1) : this.y < this.renderer.height * this.renderer.INIT_HEIGHT_RATE ? (this.vy += this.GRAVITY, this.isOut = !0) : (this.isOut && (this.ay = this.getRandomValue(-.2, -.05)), this.isOut = !1), this.isOut || (this.theta += Math.PI / 20, this.theta %= 2 * Math.PI, this.phi += Math.PI / 30, this.phi %= 2 * Math.PI), this.renderer.generateEpicenter(this.x + (this.direction ? -1 : 1) * this.renderer.THRESHOLD, this.y, this.y - this.previousY), (this.vx > 0 && this.x > this.renderer.width + this.renderer.THRESHOLD || this.vx < 0 && this.x < -this.renderer.THRESHOLD) && this.init()
    },
    render: function (t) {
      t.save(), t.translate(this.x, this.y), t.rotate(Math.PI + Math.atan2(this.vy, this.vx)), t.scale(1, this.direction ? 1 : -1), t.beginPath(), t.moveTo(-30, 0), t.bezierCurveTo(-20, 15, 15, 10, 40, 0), t.bezierCurveTo(15, -10, -20, -15, -30, 0), t.fill(), t.save(), t.translate(40, 0), t.scale(.9 + .2 * Math.sin(this.theta), 1), t.beginPath(), t.moveTo(0, 0), t.quadraticCurveTo(5, 10, 20, 8), t.quadraticCurveTo(12, 5, 10, 0), t.quadraticCurveTo(12, -5, 20, -8), t.quadraticCurveTo(5, -10, 0, 0), t.fill(), t.restore(), t.save(), t.translate(-3, 0), t.rotate((Math.PI / 3 + Math.PI / 10 * Math.sin(this.phi)) * (this.renderer.reverse ? -1 : 1)), t.beginPath(), this.renderer.reverse ? (t.moveTo(5, 0), t.bezierCurveTo(10, 10, 10, 30, 0, 40), t.bezierCurveTo(-12, 25, -8, 10, 0, 0)) : (t.moveTo(-5, 0), t.bezierCurveTo(-10, -10, -10, -30, 0, -40), t.bezierCurveTo(12, -25, 8, -10, 0, 0)), t.closePath(), t.fill(), t.restore(), t.restore(), this.controlStatus(t)
    }
  }, $(function () {
    RENDERER.init()
    $('.dark').click(function () {
      setTimeout(() => {
        RENDERER.setFishColor();
        RENDERER.context.fill();
      });
    })
  });
</script>
  
  <div class="footer bg-color">
    <div class="footer-main">
      
        
          <div class="link">
            
          </div>
        
      
        
          <div class="footer-copyright">
            <p>Copyright © 2019 - 2020 <a target="_blank" rel="noopener" href="https://github.com/yuang01">yuang01</a> | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/yuang01/theme">Bamboo</a> </p>

          </div>
        
      
        
          
            <!-- 不蒜子统计 -->
            <!-- 不蒜子统计 -->
<span id="busuanzi_container_site_pv">
      <i class="fas fa-eye" aria-hidden="true"></i>本站总访问量：<span id="busuanzi_value_site_pv"></span> 次
</span>
<span class="post-meta-divider">|</span>
<span id="busuanzi_container_site_uv" style='display:none'>
      <i class="fas fa-users" aria-hidden="true"></i>本站访客数：<span id="busuanzi_value_site_uv"></span> 人
</span>

          
        
      
        
          <div class="footer-custom">
            
          </div>
        
      
    </div>
  </div>



    <!-- 渲染暗黑按钮 -->
    
      <div class="dark">
  <div class="dark-content">
    <i class="fas fa-moon" aria-hidden="true"></i>
    <!-- <span>关灯</span> -->
  </div>
  
</div>

<script>
  $(function() {
    let isDark = JSON.parse(localStorage.getItem('dark'))  || JSON.parse('false');
    if (isDark) {
      $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
          </div>
          `
        );
    }
    $('.dark').click(function() {
      if ($(document.body).is('.darkModel')) {
        $(document.body).removeClass('darkModel');
        localStorage.setItem('dark', false);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-moon" aria-hidden="true"></i>
          </div>
          `
        );
      } else {
        $(document.body).addClass('darkModel');
        localStorage.setItem('dark', true);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
          </div>
          `
        );
      }
    })
  })
</script>
    
    <!-- 渲染回到顶部按钮 -->
    
      <div class="goTop top-btn-color" pointer>
  <i class="fas fa-arrow-up" aria-hidden="true"></i>
</div>
<script src="/js/goTop.js"></script>

    
    <!-- 渲染左下角音乐播放器 -->
    

    <!-- 图片放大 -->
    
      <script src="/js/fancybox/jquery.fancybox.min.js"></script>
    

    <!-- 百度解析 -->
    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- 背景彩带 -->
    
      <script type="text/javascript" size="100" alpha='0.4' zIndex="-1" src="/js/ribbon.min.js"></script>
    

    <script src="/js/utils/index.js"></script>
    <script src="/js/app.js"></script>
    
    <!-- 文章目录所需js -->
<!-- <link href="/js/tocbot/tocbot.css" rel="stylesheet">
<script src="/js/tocbot/tocbot.min.js"></script> -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.css">

<script>
  var headerEl = 'h2, h3, h4',  //headers 
    content = '.post-detail',//文章容器
    idArr = {};  //标题数组以确定是否增加索引id
  //add #id
  var option = {
    // Where to render the table of contents.
    tocSelector: '.toc',
    // Where to grab the headings to build the table of contents.
    contentSelector: content,
    // Which headings to grab inside of the contentSelector element.
    headingSelector: headerEl,
    scrollSmooth: true,
    scrollSmoothOffset: -70,
    // headingsOffset: -($(window).height() * 0.4 - 45),
    headingsOffset: -($(window).height() * 0.4 - 70),
    // positionFixedSelector: '.toc-main',
    // positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
    activeLinkClass: 'is-active-link',
    orderedList: true,
    collapseDepth: 20,
    // onClick: function (e) {},
  }
  if ($('.toc').length > 0) {

    $(content).children(headerEl).each(function () {
      //去除空格以及多余标点
      var headerId = $(this).text().replace(/[\s|\~|`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\||\|\[|\]|\{|\}|\;|\:|\"|\'|\,|\<|\.|\>|\/|\?|\：|\，|\。]/g, '');

      headerId = headerId.toLowerCase();
      if (idArr[headerId]) {
        //id已经存在
        $(this).attr('id', headerId + '-' + idArr[headerId]);
        idArr[headerId]++;
      }
      else {
        //id未存在
        idArr[headerId] = 1;
        $(this).attr('id', headerId);
      }
    });

    document.addEventListener("DOMContentLoaded", function () {
      tocbot.init(option);
      mobileTocClick();
    });

  }

  window.tocScrollFn = function () {
    return bamboo.throttle(function () {
      findHeadPosition();
    }, 100)()
  }
  window.addEventListener('scroll', tocScrollFn);

  const findHeadPosition = function (top) {
    if ($('.toc-list').length <= 0) {
      return false;
    }
    setTimeout(() => {  // or DOMContentLoaded 
      autoScrollToc();
    }, 0);
  }

  const autoScrollToc = function () {
    const $activeItem = document.querySelector('.is-active-link');
    const $cardToc = document.querySelector('.toc-content');
    const activePosition = $activeItem.getBoundingClientRect().top
    const sidebarScrollTop = $cardToc.scrollTop
    if (activePosition > (document.documentElement.clientHeight - 100)) {
      $cardToc.scrollTop = sidebarScrollTop + 150
    }
    if (activePosition < 150) {
      $cardToc.scrollTop = sidebarScrollTop - 150
    }
  }

  document.addEventListener('pjax:send', function () {
    if ($('.toc').length) {
      tocbot.destroy();
    }
  });

  document.addEventListener('pjax:complete', function () {
    if ($('.toc').length) {
      tocbot.init(option);
      mobileTocClick();
    }
  });
  
  // 手机端toc按钮点击出现目录
  const mobileTocClick = function () {
    const $cardTocLayout = document.getElementsByClassName('side_toc')[0];
    const $cardToc = $cardTocLayout.getElementsByClassName('toc-content')[0];
    let right = '45px';
    if (window.innerWidth >= 551 && window.innerWidth <= 992) {
      right = '100px'
    }
    const mobileToc = {
      open: () => {
        $cardTocLayout.style.cssText = 'animation: toc-open .3s; opacity: 1; right: ' + right
      },

      close: () => {
        $cardTocLayout.style.animation = 'toc-close .2s'
        setTimeout(() => {
          $cardTocLayout.style.cssText = "opacity:''; animation: ''; right: ''"
        }, 100)
      }
    }
    document.getElementById('toc-mobile-btn').addEventListener('click', () => {
      if (window.getComputedStyle($cardTocLayout).getPropertyValue('opacity') === '0') mobileToc.open()
      else mobileToc.close()
    })

    $cardToc.addEventListener('click', (e) => {
      if (window.innerWidth < 992) { // 小于992px的时候
        mobileToc.close()
      }
    })
  }
</script>

<style>
  /* .is-position-fixed {
    position: sticky !important;
    top: 74px;
  }

  .toc-main ul {
    counter-reset: show-list;
  }

  .toc-main ul li::before {
    content: counter(item)".";
    display: block;
    position: absolute;
    left: 12px;
    top: 0;
  } */
</style>
 

<!-- 设置导航背景 -->
<script>
  let setHeaderClass = () => {
    const nav = $('#navHeader');
    const navTop = nav.outerHeight();
    const winTop = $(window).scrollTop();
    if(winTop > navTop) {
      nav.addClass('header-bg-color');
    }
    else {
      nav.removeClass('header-bg-color');
    }
  };

  let scrollCollect = () => {
    return bamboo.throttle(function (e) {
      setHeaderClass();
    }, 200)()
  }

  let initHeaderBg = () => {
    setHeaderClass();
  }

  setHeaderClass();
  window.addEventListener('scroll', scrollCollect);

  document.addEventListener('pjax:send', function () {
    window.removeEventListener('scroll', scrollCollect)
  })
  document.addEventListener('pjax:complete', function () {
    window.addEventListener('scroll', scrollCollect);
    setHeaderClass();
  })
</script> 

<!-- 渲染issues标签里的内容 -->
<script>
  function loadIssuesJS() {
    if ($(".post-detail").find(".issues-api").length == 0) {
      return;
    } 
    loadScript('/js/issues/index.js');
  };
  $(function () {
    loadIssuesJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof IssuesAPI == "undefined") {
      loadIssuesJS();
    }
  })
</script>

<!-- 输入框打字特效 -->
<!-- 输入框打字特效 -->

  <script src="/js/activate-power-mode.js"></script>
  <script>
    POWERMODE.colorful = true;  // 打开随机颜色特效
    POWERMODE.shake = false;    // 关闭输入框抖动
    document.body.addEventListener('input', POWERMODE);//监听打字事件
  </script>


<!-- markdown代码一键复制功能 -->

  <link rel="stylesheet" href="https://unpkg.com/v-plugs-ayu/lib/ayu.css">
  <script src="https://unpkg.com/v-plugs-ayu/lib/ayu.umd.min.js"></script>
  <script src="/js/clipboard/clipboard.min.js"></script>
  <div id="appCopy">
  </div>
  <script data-pjax>
    var vm = new Vue({
      el: '#appCopy',
      data: {
      },
      computed: {
      },
      mounted() {
        const that = this;
        var copy = '复制';
        /* code */
        var initCopyCode = function () {
          var copyHtml = '';
          copyHtml += '<button class="btn-copy" data-clipboard-snippet="" style="position:absolute;top:0;right:0;z-index:1;">';
          copyHtml += '<i class="fas fa-copy"></i><span>' + copy + '</span>';
          copyHtml += '</button>';
          $(".post-detail pre").not('.gutter pre').wrap("<div class='codeBox' style='position:relative;width:100%;'></div>")
          $(".post-detail pre").not('.gutter pre').before(copyHtml);
          new ClipboardJS('.btn-copy', {
            target: function (trigger) {
              return trigger.nextElementSibling;
            }
          });
        }
        initCopyCode();
        $('.btn-copy').unbind('click').bind('click', function () {
          doSomething();
        })
        $(document).unbind('keypress').bind('keypress', function (e) {
          if (e.ctrlKey && e.keyCode == 67) {
            doSomething();
          }
        })

        function doSomething() {
          that.$notify({
            title: "成功",
            content: "代码已复制，请遵守相关授权协议。",
            type: 'success'
          })
        }
      },
      methods: {
      },
      created() { }
    })
  </script>
  

<!-- 图片懒加载 -->
<script defer src="https://unpkg.com/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script>


<!-- 卡片滚动动画 -->
   

<!-- 评论所需js -->

  
    <script src='https://unpkg.com/gitment@0.0.3/dist/gitment.browser.js'></script>

<script>
comment_el = '#gitment-ctn';
load_gitment = function () {
  if ($(comment_el).length) {
    var gitment = new Gitment({
      id: "2023/04/15/sketch-diao-yan/",
      owner: '',
      repo: '',
      oauth: {
        client_id: '',
        client_secret: '',
      },
    })
    gitment.render('gitment-ctn')
  }
}
$(document).ready(load_gitment);
document.addEventListener('pjax:complete', function () {
    load_gitment();
});
</script>
  


<!-- 鼠标点击特效 -->
<!-- 爱心点击 -->

  
    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 999; pointer-events: none;" ></canvas>
    <script src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
    <script src="/js/cursor/explosion.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" data-pjax></script>


<!-- 轮播图标签 -->
<script>
  var bambooSwiperTag = {};
  function load_swiper() {
    if (!document.querySelectorAll(".post-swiper-container")[0]) return;
    loadCSS("https://unpkg.com/swiper@6/swiper-bundle.min.css")
    loadScript("https://unpkg.com/swiper@6/swiper-bundle.min.js").then(() => {
      pjax_swiper();
    });
  }

  load_swiper();

  function pjax_swiper() {
    bambooSwiperTag.swiper = new Swiper('.post-swiper-container', {
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      loop: true,
      autoplay: true ? {
        delay: 3000,
        stopOnLastSlide: false,
        disableOnInteraction: false,
      } : false,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      on:{
        init: function(){
          swiperAnimateCache(this); //隐藏动画元素 
          swiperAnimate(this); //初始化完成开始动画
        }, 
        slideChangeTransitionEnd: function(){ 
          swiperAnimate(this); //每个slide切换结束时也运行当前slide动画
          //this.slides.eq(this.activeIndex).find('.ani').removeClass('ani'); 动画只展现一次，去除ani类名
        } 
      }
    });
  }

  document.addEventListener('pjax:complete', function () {
    if (!document.querySelectorAll(".post-swiper-container")[0]) return;
    if (typeof bambooSwiperTag.swiper === "undefined") {
      load_swiper();
    } else {
      pjax_swiper();
    }
  });
</script>
    <!-- pjax -->
    

<!-- pjax -->


  <script src="/js/pjax@0.2.8/index.js"></script>
  
    <!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <div class="loading-circle"><div id="loader-circle"></div></div>
    <script>
      window.ShowLoading = function() {
        $(".loading-circle").css("display", "block");
      };
      window.HideLoading = function() {
        $(".loading-circle").css("display", "none");
      }
    </script>
  
	<script>
    document.addEventListener('pjax:complete', function () {
      window.HideLoading();
    })
    document.addEventListener('pjax:send', function () {
      window.ShowLoading();
    })
    document.addEventListener('pjax:error', function () {
      window.HideLoading();
    })
	</script>
</div>

  

  <script>
    var pjax = new Pjax({
      elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([no-pjax])',   // 拦截正常带链接的 a 标签
      selectors: ["#pjax-container","title"],                                   // 根据实际需要确认重载区域
      cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
      timeout: 5000
    });

    document.addEventListener('pjax:send', function (e) {

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');

    })
    
    document.addEventListener('pjax:complete', function () {
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
    });

    document.addEventListener('pjax:error', function (e) {
      window.location.href = e.triggerElement.href;
    })
    
    // 刷新不从顶部开始
    document.addEventListener("DOMContentLoaded", function () {
      history.scrollRestoration = 'auto';
    })
  </script>



  </body>
</html>